{"version":3,"sources":["../index.js"],"names":["module","exports","debounce","fn","wait","options","lastCallAt","deferred","timer","pendingArgs","debounced","currentWait","getWait","currentTime","Date","getTime","isCold","args","leading","accumulate","Promise","resolve","call","then","result","clearTimeout","defer","push","setTimeout","flush","bind","argsIndex","length","promise","results","thisDeferred","apply","reject"],"mappings":";;AAAA;;AAEAA,OAAOC,OAAP,GAAiB,SAASC,QAAT,CAAmBC,EAAnB,EAA+C;AAAA,MAAxBC,IAAwB,uEAAjB,CAAiB;AAAA,MAAdC,OAAc,uEAAJ,EAAI;;AAC9D,MAAIC,mBAAJ;AACA,MAAIC,iBAAJ;AACA,MAAIC,cAAJ;AACA,MAAIC,cAAc,EAAlB;AACA,SAAO,SAASC,SAAT,GAA6B;AAClC,QAAMC,cAAcC,QAAQR,IAAR,CAApB;AACA,QAAMS,cAAc,IAAIC,IAAJ,GAAWC,OAAX,EAApB;;AAEA,QAAMC,SAAS,CAACV,UAAD,IAAgBO,cAAcP,UAAf,GAA6BK,WAA3D;;AAEAL,iBAAaO,WAAb;;AANkC,sCAANI,IAAM;AAANA,UAAM;AAAA;;AAQlC,QAAID,UAAUX,QAAQa,OAAtB,EAA+B;AAC7B,aAAOb,QAAQc,UAAR,GACHC,QAAQC,OAAR,CAAgBlB,GAAGmB,IAAH,CAAQ,IAAR,EAAc,CAACL,IAAD,CAAd,CAAhB,EAAuCM,IAAvC,CAA4C;AAAA,eAAUC,OAAO,CAAP,CAAV;AAAA,OAA5C,CADG,GAEHJ,QAAQC,OAAR,CAAgBlB,GAAGmB,IAAH,YAAQ,IAAR,SAAiBL,IAAjB,EAAhB,CAFJ;AAGD;;AAED,QAAIV,QAAJ,EAAc;AACZkB,mBAAajB,KAAb;AACD,KAFD,MAEO;AACLD,iBAAWmB,OAAX;AACD;;AAEDjB,gBAAYkB,IAAZ,CAAiBV,IAAjB;AACAT,YAAQoB,WAAWC,MAAMC,IAAN,CAAW,IAAX,CAAX,EAA6BnB,WAA7B,CAAR;;AAEA,QAAIN,QAAQc,UAAZ,EAAwB;AACtB,UAAMY,YAAYtB,YAAYuB,MAAZ,GAAqB,CAAvC;AACA,aAAOzB,SAAS0B,OAAT,CAAiBV,IAAjB,CAAsB;AAAA,eAAWW,QAAQH,SAAR,CAAX;AAAA,OAAtB,CAAP;AACD;;AAED,WAAOxB,SAAS0B,OAAhB;AACD,GA7BD;;AA+BA,WAASJ,KAAT,GAAkB;AAChB,QAAMM,eAAe5B,QAArB;AACAkB,iBAAajB,KAAb;;AAEAY,YAAQC,OAAR,CACEhB,QAAQc,UAAR,GACIhB,GAAGmB,IAAH,CAAQ,IAAR,EAAcb,WAAd,CADJ,GAEIN,GAAGiC,KAAH,CAAS,IAAT,EAAe3B,YAAYA,YAAYuB,MAAZ,GAAqB,CAAjC,CAAf,CAHN,EAKGT,IALH,CAKQY,aAAad,OALrB,EAK8Bc,aAAaE,MAL3C;;AAOA5B,kBAAc,EAAd;AACAF,eAAW,IAAX;AACD;AACF,CAlDD;;AAoDA,SAASK,OAAT,CAAkBR,IAAlB,EAAwB;AACtB,SAAQ,OAAOA,IAAP,KAAgB,UAAjB,GAA+BA,MAA/B,GAAwCA,IAA/C;AACD;;AAED,SAASsB,KAAT,GAAkB;AAChB,MAAMnB,WAAW,EAAjB;AACAA,WAAS0B,OAAT,GAAmB,IAAIb,OAAJ,CAAY,UAACC,OAAD,EAAUgB,MAAV,EAAqB;AAClD9B,aAASc,OAAT,GAAmBA,OAAnB;AACAd,aAAS8B,MAAT,GAAkBA,MAAlB;AACD,GAHkB,CAAnB;AAIA,SAAO9B,QAAP;AACD","file":"index.js","sourcesContent":["/* global setTimeout, clearTimeout */\n\nmodule.exports = function debounce (fn, wait = 0, options = {}) {\n  let lastCallAt\n  let deferred\n  let timer\n  let pendingArgs = []\n  return function debounced (...args) {\n    const currentWait = getWait(wait)\n    const currentTime = new Date().getTime()\n\n    const isCold = !lastCallAt || (currentTime - lastCallAt) > currentWait\n\n    lastCallAt = currentTime\n\n    if (isCold && options.leading) {\n      return options.accumulate\n        ? Promise.resolve(fn.call(this, [args])).then(result => result[0])\n        : Promise.resolve(fn.call(this, ...args))\n    }\n\n    if (deferred) {\n      clearTimeout(timer)\n    } else {\n      deferred = defer()\n    }\n\n    pendingArgs.push(args)\n    timer = setTimeout(flush.bind(this), currentWait)\n\n    if (options.accumulate) {\n      const argsIndex = pendingArgs.length - 1\n      return deferred.promise.then(results => results[argsIndex])\n    }\n\n    return deferred.promise\n  }\n\n  function flush () {\n    const thisDeferred = deferred\n    clearTimeout(timer)\n\n    Promise.resolve(\n      options.accumulate\n        ? fn.call(this, pendingArgs)\n        : fn.apply(this, pendingArgs[pendingArgs.length - 1])\n    )\n      .then(thisDeferred.resolve, thisDeferred.reject)\n\n    pendingArgs = []\n    deferred = null\n  }\n}\n\nfunction getWait (wait) {\n  return (typeof wait === 'function') ? wait() : wait\n}\n\nfunction defer () {\n  const deferred = {}\n  deferred.promise = new Promise((resolve, reject) => {\n    deferred.resolve = resolve\n    deferred.reject = reject\n  })\n  return deferred\n}\n"]}