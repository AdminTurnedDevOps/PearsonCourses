{"version":3,"file":"closebrackets.cjs.js","sources":["../../../node_modules/codemirror/addon/edit/closebrackets.js"],"sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n  var defaults = {\n    pairs: \"()[]{}''\\\"\\\"\",\n    closeBefore: \")]}'\\\":;>\",\n    triples: \"\",\n    explode: \"[]{}\"\n  };\n\n  var Pos = CodeMirror.Pos;\n\n  CodeMirror.defineOption(\"autoCloseBrackets\", false, function(cm, val, old) {\n    if (old && old != CodeMirror.Init) {\n      cm.removeKeyMap(keyMap);\n      cm.state.closeBrackets = null;\n    }\n    if (val) {\n      ensureBound(getOption(val, \"pairs\"))\n      cm.state.closeBrackets = val;\n      cm.addKeyMap(keyMap);\n    }\n  });\n\n  function getOption(conf, name) {\n    if (name == \"pairs\" && typeof conf == \"string\") return conf;\n    if (typeof conf == \"object\" && conf[name] != null) return conf[name];\n    return defaults[name];\n  }\n\n  var keyMap = {Backspace: handleBackspace, Enter: handleEnter};\n  function ensureBound(chars) {\n    for (var i = 0; i < chars.length; i++) {\n      var ch = chars.charAt(i), key = \"'\" + ch + \"'\"\n      if (!keyMap[key]) keyMap[key] = handler(ch)\n    }\n  }\n  ensureBound(defaults.pairs + \"`\")\n\n  function handler(ch) {\n    return function(cm) { return handleChar(cm, ch); };\n  }\n\n  function getConfig(cm) {\n    var deflt = cm.state.closeBrackets;\n    if (!deflt || deflt.override) return deflt;\n    var mode = cm.getModeAt(cm.getCursor());\n    return mode.closeBrackets || deflt;\n  }\n\n  function handleBackspace(cm) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || pairs.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    for (var i = ranges.length - 1; i >= 0; i--) {\n      var cur = ranges[i].head;\n      cm.replaceRange(\"\", Pos(cur.line, cur.ch - 1), Pos(cur.line, cur.ch + 1), \"+delete\");\n    }\n  }\n\n  function handleEnter(cm) {\n    var conf = getConfig(cm);\n    var explode = conf && getOption(conf, \"explode\");\n    if (!explode || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var ranges = cm.listSelections();\n    for (var i = 0; i < ranges.length; i++) {\n      if (!ranges[i].empty()) return CodeMirror.Pass;\n      var around = charsAround(cm, ranges[i].head);\n      if (!around || explode.indexOf(around) % 2 != 0) return CodeMirror.Pass;\n    }\n    cm.operation(function() {\n      var linesep = cm.lineSeparator() || \"\\n\";\n      cm.replaceSelection(linesep + linesep, null);\n      moveSel(cm, -1)\n      ranges = cm.listSelections();\n      for (var i = 0; i < ranges.length; i++) {\n        var line = ranges[i].head.line;\n        cm.indentLine(line, null, true);\n        cm.indentLine(line + 1, null, true);\n      }\n    });\n  }\n\n  function moveSel(cm, dir) {\n    var newRanges = [], ranges = cm.listSelections(), primary = 0\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i]\n      if (range.head == cm.getCursor()) primary = i\n      var pos = range.head.ch || dir > 0 ? {line: range.head.line, ch: range.head.ch + dir} : {line: range.head.line - 1}\n      newRanges.push({anchor: pos, head: pos})\n    }\n    cm.setSelections(newRanges, primary)\n  }\n\n  function contractSelection(sel) {\n    var inverted = CodeMirror.cmpPos(sel.anchor, sel.head) > 0;\n    return {anchor: new Pos(sel.anchor.line, sel.anchor.ch + (inverted ? -1 : 1)),\n            head: new Pos(sel.head.line, sel.head.ch + (inverted ? 1 : -1))};\n  }\n\n  function handleChar(cm, ch) {\n    var conf = getConfig(cm);\n    if (!conf || cm.getOption(\"disableInput\")) return CodeMirror.Pass;\n\n    var pairs = getOption(conf, \"pairs\");\n    var pos = pairs.indexOf(ch);\n    if (pos == -1) return CodeMirror.Pass;\n\n    var closeBefore = getOption(conf,\"closeBefore\");\n\n    var triples = getOption(conf, \"triples\");\n\n    var identical = pairs.charAt(pos + 1) == ch;\n    var ranges = cm.listSelections();\n    var opening = pos % 2 == 0;\n\n    var type;\n    for (var i = 0; i < ranges.length; i++) {\n      var range = ranges[i], cur = range.head, curType;\n      var next = cm.getRange(cur, Pos(cur.line, cur.ch + 1));\n      if (opening && !range.empty()) {\n        curType = \"surround\";\n      } else if ((identical || !opening) && next == ch) {\n        if (identical && stringStartsAfter(cm, cur))\n          curType = \"both\";\n        else if (triples.indexOf(ch) >= 0 && cm.getRange(cur, Pos(cur.line, cur.ch + 3)) == ch + ch + ch)\n          curType = \"skipThree\";\n        else\n          curType = \"skip\";\n      } else if (identical && cur.ch > 1 && triples.indexOf(ch) >= 0 &&\n                 cm.getRange(Pos(cur.line, cur.ch - 2), cur) == ch + ch) {\n        if (cur.ch > 2 && /\\bstring/.test(cm.getTokenTypeAt(Pos(cur.line, cur.ch - 2)))) return CodeMirror.Pass;\n        curType = \"addFour\";\n      } else if (identical) {\n        var prev = cur.ch == 0 ? \" \" : cm.getRange(Pos(cur.line, cur.ch - 1), cur)\n        if (!CodeMirror.isWordChar(next) && prev != ch && !CodeMirror.isWordChar(prev)) curType = \"both\";\n        else return CodeMirror.Pass;\n      } else if (opening && (next.length === 0 || /\\s/.test(next) || closeBefore.indexOf(next) > -1)) {\n        curType = \"both\";\n      } else {\n        return CodeMirror.Pass;\n      }\n      if (!type) type = curType;\n      else if (type != curType) return CodeMirror.Pass;\n    }\n\n    var left = pos % 2 ? pairs.charAt(pos - 1) : ch;\n    var right = pos % 2 ? ch : pairs.charAt(pos + 1);\n    cm.operation(function() {\n      if (type == \"skip\") {\n        moveSel(cm, 1)\n      } else if (type == \"skipThree\") {\n        moveSel(cm, 3)\n      } else if (type == \"surround\") {\n        var sels = cm.getSelections();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = left + sels[i] + right;\n        cm.replaceSelections(sels, \"around\");\n        sels = cm.listSelections().slice();\n        for (var i = 0; i < sels.length; i++)\n          sels[i] = contractSelection(sels[i]);\n        cm.setSelections(sels);\n      } else if (type == \"both\") {\n        cm.replaceSelection(left + right, null);\n        cm.triggerElectric(left + right);\n        moveSel(cm, -1)\n      } else if (type == \"addFour\") {\n        cm.replaceSelection(left + left + left + left, \"before\");\n        moveSel(cm, 1)\n      }\n    });\n  }\n\n  function charsAround(cm, pos) {\n    var str = cm.getRange(Pos(pos.line, pos.ch - 1),\n                          Pos(pos.line, pos.ch + 1));\n    return str.length == 2 ? str : null;\n  }\n\n  function stringStartsAfter(cm, pos) {\n    var token = cm.getTokenAt(Pos(pos.line, pos.ch + 1))\n    return /\\bstring/.test(token.type) && token.start == pos.ch &&\n      (pos.ch == 0 || !/\\bstring/.test(cm.getTokenTypeAt(pos)))\n  }\n});\n"],"names":["mod","require$$0","CodeMirror","defaults","Pos","cm","val","old","keyMap","ensureBound","getOption","conf","name","__name","handleBackspace","handleEnter","chars","i","ch","key","handler","handleChar","getConfig","deflt","mode","pairs","ranges","around","charsAround","cur","explode","linesep","moveSel","line","dir","newRanges","primary","range","pos","contractSelection","sel","inverted","closeBefore","triples","identical","opening","type","curType","next","stringStartsAfter","prev","left","right","sels","str","token"],"mappings":"qhBAGC,SAASA,EAAK,CAEXA,EAAIC,EAA+B,kBAAA,CAAA,CAKtC,GAAE,SAASC,EAAY,CACtB,IAAIC,EAAW,CACb,MAAO,aACP,YAAa,WACb,QAAS,GACT,QAAS,MACb,EAEMC,EAAMF,EAAW,IAErBA,EAAW,aAAa,oBAAqB,GAAO,SAASG,EAAIC,EAAKC,EAAK,CACrEA,GAAOA,GAAOL,EAAW,OAC3BG,EAAG,aAAaG,CAAM,EACtBH,EAAG,MAAM,cAAgB,MAEvBC,IACFG,EAAYC,EAAUJ,EAAK,OAAO,CAAC,EACnCD,EAAG,MAAM,cAAgBC,EACzBD,EAAG,UAAUG,CAAM,EAEzB,CAAG,EAED,SAASE,EAAUC,EAAMC,EAAM,CAC7B,OAAIA,GAAQ,SAAW,OAAOD,GAAQ,SAAiBA,EACnD,OAAOA,GAAQ,UAAYA,EAAKC,CAAI,GAAK,KAAaD,EAAKC,CAAI,EAC5DT,EAASS,CAAI,CACrB,CAJQC,EAAAH,EAAA,aAMT,IAAIF,EAAS,CAAC,UAAWM,EAAiB,MAAOC,CAAW,EAC5D,SAASN,EAAYO,EAAO,CAC1B,QAASC,EAAI,EAAGA,EAAID,EAAM,OAAQC,IAAK,CACrC,IAAIC,EAAKF,EAAM,OAAOC,CAAC,EAAGE,EAAM,IAAMD,EAAK,IACtCV,EAAOW,CAAG,IAAGX,EAAOW,CAAG,EAAIC,EAAQF,CAAE,GAE7C,CALQL,EAAAJ,EAAA,eAMTA,EAAYN,EAAS,MAAQ,GAAG,EAEhC,SAASiB,EAAQF,EAAI,CACnB,OAAO,SAASb,EAAI,CAAE,OAAOgB,EAAWhB,EAAIa,CAAE,EAC/C,CAFQL,EAAAO,EAAA,WAIT,SAASE,EAAUjB,EAAI,CACrB,IAAIkB,EAAQlB,EAAG,MAAM,cACrB,GAAI,CAACkB,GAASA,EAAM,SAAU,OAAOA,EACrC,IAAIC,EAAOnB,EAAG,UAAUA,EAAG,UAAW,CAAA,EACtC,OAAOmB,EAAK,eAAiBD,CAC9B,CALQV,EAAAS,EAAA,aAOT,SAASR,EAAgBT,EAAI,CAC3B,IAAIM,EAAOW,EAAUjB,CAAE,EACvB,GAAI,CAACM,GAAQN,EAAG,UAAU,cAAc,EAAG,OAAOH,EAAW,KAI7D,QAFIuB,EAAQf,EAAUC,EAAM,OAAO,EAC/Be,EAASrB,EAAG,iBACPY,EAAI,EAAGA,EAAIS,EAAO,OAAQT,IAAK,CACtC,GAAI,CAACS,EAAOT,CAAC,EAAE,MAAK,EAAI,OAAOf,EAAW,KAC1C,IAAIyB,EAASC,EAAYvB,EAAIqB,EAAOT,CAAC,EAAE,IAAI,EAC3C,GAAI,CAACU,GAAUF,EAAM,QAAQE,CAAM,EAAI,GAAK,EAAG,OAAOzB,EAAW,KAEnE,QAASe,EAAIS,EAAO,OAAS,EAAGT,GAAK,EAAGA,IAAK,CAC3C,IAAIY,EAAMH,EAAOT,CAAC,EAAE,KACpBZ,EAAG,aAAa,GAAID,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,EAAGzB,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,EAAG,SAAS,EAEtF,CAfQhB,EAAAC,EAAA,mBAiBT,SAASC,EAAYV,EAAI,CACvB,IAAIM,EAAOW,EAAUjB,CAAE,EACnByB,EAAUnB,GAAQD,EAAUC,EAAM,SAAS,EAC/C,GAAI,CAACmB,GAAWzB,EAAG,UAAU,cAAc,EAAG,OAAOH,EAAW,KAGhE,QADIwB,EAASrB,EAAG,iBACPY,EAAI,EAAGA,EAAIS,EAAO,OAAQT,IAAK,CACtC,GAAI,CAACS,EAAOT,CAAC,EAAE,MAAK,EAAI,OAAOf,EAAW,KAC1C,IAAIyB,EAASC,EAAYvB,EAAIqB,EAAOT,CAAC,EAAE,IAAI,EAC3C,GAAI,CAACU,GAAUG,EAAQ,QAAQH,CAAM,EAAI,GAAK,EAAG,OAAOzB,EAAW,KAErEG,EAAG,UAAU,UAAW,CACtB,IAAI0B,EAAU1B,EAAG,cAAa,GAAM;AAAA,EACpCA,EAAG,iBAAiB0B,EAAUA,EAAS,IAAI,EAC3CC,EAAQ3B,EAAI,EAAE,EACdqB,EAASrB,EAAG,iBACZ,QAASY,EAAI,EAAGA,EAAIS,EAAO,OAAQT,IAAK,CACtC,IAAIgB,EAAOP,EAAOT,CAAC,EAAE,KAAK,KAC1BZ,EAAG,WAAW4B,EAAM,KAAM,EAAI,EAC9B5B,EAAG,WAAW4B,EAAO,EAAG,KAAM,EAAI,EAE1C,CAAK,CACF,CAtBQpB,EAAAE,EAAA,eAwBT,SAASiB,EAAQ3B,EAAI6B,EAAK,CAExB,QADIC,EAAY,CAAA,EAAIT,EAASrB,EAAG,eAAc,EAAI+B,EAAU,EACnDnB,EAAI,EAAGA,EAAIS,EAAO,OAAQT,IAAK,CACtC,IAAIoB,EAAQX,EAAOT,CAAC,EAChBoB,EAAM,MAAQhC,EAAG,UAAW,IAAE+B,EAAUnB,GAC5C,IAAIqB,EAAMD,EAAM,KAAK,IAAMH,EAAM,EAAI,CAAC,KAAMG,EAAM,KAAK,KAAM,GAAIA,EAAM,KAAK,GAAKH,CAAG,EAAI,CAAC,KAAMG,EAAM,KAAK,KAAO,CAAC,EAClHF,EAAU,KAAK,CAAC,OAAQG,EAAK,KAAMA,CAAG,CAAC,EAEzCjC,EAAG,cAAc8B,EAAWC,CAAO,CACpC,CATQvB,EAAAmB,EAAA,WAWT,SAASO,EAAkBC,EAAK,CAC9B,IAAIC,EAAWvC,EAAW,OAAOsC,EAAI,OAAQA,EAAI,IAAI,EAAI,EACzD,MAAO,CAAC,OAAQ,IAAIpC,EAAIoC,EAAI,OAAO,KAAMA,EAAI,OAAO,IAAMC,EAAW,GAAK,EAAE,EACpE,KAAM,IAAIrC,EAAIoC,EAAI,KAAK,KAAMA,EAAI,KAAK,IAAMC,EAAW,EAAI,GAAG,CAAC,CACxE,CAJQ5B,EAAA0B,EAAA,qBAMT,SAASlB,EAAWhB,EAAIa,EAAI,CAC1B,IAAIP,EAAOW,EAAUjB,CAAE,EACvB,GAAI,CAACM,GAAQN,EAAG,UAAU,cAAc,EAAG,OAAOH,EAAW,KAE7D,IAAIuB,EAAQf,EAAUC,EAAM,OAAO,EAC/B2B,EAAMb,EAAM,QAAQP,CAAE,EAC1B,GAAIoB,GAAO,GAAI,OAAOpC,EAAW,KAWjC,QATIwC,EAAchC,EAAUC,EAAK,aAAa,EAE1CgC,EAAUjC,EAAUC,EAAM,SAAS,EAEnCiC,EAAYnB,EAAM,OAAOa,EAAM,CAAC,GAAKpB,EACrCQ,EAASrB,EAAG,iBACZwC,EAAUP,EAAM,GAAK,EAErBQ,EACK7B,EAAI,EAAGA,EAAIS,EAAO,OAAQT,IAAK,CACtC,IAAIoB,EAAQX,EAAOT,CAAC,EAAGY,EAAMQ,EAAM,KAAMU,EACrCC,EAAO3C,EAAG,SAASwB,EAAKzB,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,CAAC,EACrD,GAAIgB,GAAW,CAACR,EAAM,QACpBU,EAAU,oBACAH,GAAa,CAACC,IAAYG,GAAQ9B,EACxC0B,GAAaK,EAAkB5C,EAAIwB,CAAG,EACxCkB,EAAU,OACHJ,EAAQ,QAAQzB,CAAE,GAAK,GAAKb,EAAG,SAASwB,EAAKzB,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,CAAC,GAAKX,EAAKA,EAAKA,EAC5F6B,EAAU,YAEVA,EAAU,eACHH,GAAaf,EAAI,GAAK,GAAKc,EAAQ,QAAQzB,CAAE,GAAK,GAClDb,EAAG,SAASD,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,EAAGA,CAAG,GAAKX,EAAKA,EAAI,CACjE,GAAIW,EAAI,GAAK,GAAK,WAAW,KAAKxB,EAAG,eAAeD,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,CAAC,CAAC,EAAG,OAAO3B,EAAW,KACnG6C,EAAU,kBACDH,EAAW,CACpB,IAAIM,EAAOrB,EAAI,IAAM,EAAI,IAAMxB,EAAG,SAASD,EAAIyB,EAAI,KAAMA,EAAI,GAAK,CAAC,EAAGA,CAAG,EACzE,GAAI,CAAC3B,EAAW,WAAW8C,CAAI,GAAKE,GAAQhC,GAAM,CAAChB,EAAW,WAAWgD,CAAI,EAAGH,EAAU,WACrF,QAAO7C,EAAW,aACd2C,IAAYG,EAAK,SAAW,GAAK,KAAK,KAAKA,CAAI,GAAKN,EAAY,QAAQM,CAAI,EAAI,IACzFD,EAAU,WAEV,QAAO7C,EAAW,KAEpB,GAAI,CAAC4C,EAAMA,EAAOC,UACTD,GAAQC,EAAS,OAAO7C,EAAW,KAG9C,IAAIiD,EAAOb,EAAM,EAAIb,EAAM,OAAOa,EAAM,CAAC,EAAIpB,EACzCkC,EAAQd,EAAM,EAAIpB,EAAKO,EAAM,OAAOa,EAAM,CAAC,EAC/CjC,EAAG,UAAU,UAAW,CACtB,GAAIyC,GAAQ,OACVd,EAAQ3B,EAAI,CAAC,UACJyC,GAAQ,YACjBd,EAAQ3B,EAAI,CAAC,UACJyC,GAAQ,WAAY,CAE7B,QADIO,EAAOhD,EAAG,gBACLY,EAAI,EAAGA,EAAIoC,EAAK,OAAQpC,IAC/BoC,EAAKpC,CAAC,EAAIkC,EAAOE,EAAKpC,CAAC,EAAImC,EAC7B/C,EAAG,kBAAkBgD,EAAM,QAAQ,EACnCA,EAAOhD,EAAG,eAAgB,EAAC,MAAK,EAChC,QAASY,EAAI,EAAGA,EAAIoC,EAAK,OAAQpC,IAC/BoC,EAAKpC,CAAC,EAAIsB,EAAkBc,EAAKpC,CAAC,CAAC,EACrCZ,EAAG,cAAcgD,CAAI,OACZP,GAAQ,QACjBzC,EAAG,iBAAiB8C,EAAOC,EAAO,IAAI,EACtC/C,EAAG,gBAAgB8C,EAAOC,CAAK,EAC/BpB,EAAQ3B,EAAI,EAAE,GACLyC,GAAQ,YACjBzC,EAAG,iBAAiB8C,EAAOA,EAAOA,EAAOA,EAAM,QAAQ,EACvDnB,EAAQ3B,EAAI,CAAC,EAErB,CAAK,CACF,CAvEQQ,EAAAQ,EAAA,cAyET,SAASO,EAAYvB,EAAIiC,EAAK,CAC5B,IAAIgB,EAAMjD,EAAG,SAASD,EAAIkC,EAAI,KAAMA,EAAI,GAAK,CAAC,EACxBlC,EAAIkC,EAAI,KAAMA,EAAI,GAAK,CAAC,CAAC,EAC/C,OAAOgB,EAAI,QAAU,EAAIA,EAAM,IAChC,CAJQzC,EAAAe,EAAA,eAMT,SAASqB,EAAkB5C,EAAIiC,EAAK,CAClC,IAAIiB,EAAQlD,EAAG,WAAWD,EAAIkC,EAAI,KAAMA,EAAI,GAAK,CAAC,CAAC,EACnD,MAAO,WAAW,KAAKiB,EAAM,IAAI,GAAKA,EAAM,OAASjB,EAAI,KACtDA,EAAI,IAAM,GAAK,CAAC,WAAW,KAAKjC,EAAG,eAAeiC,CAAG,CAAC,EAC1D,CAJQzB,EAAAoC,EAAA,oBAKX,CAAC","x_google_ignoreList":[0]}