{"version":3,"file":"jump.cjs.js","sources":["../../codemirror-graphql/esm/utils/jump-addon.js","../../codemirror-graphql/esm/jump.js"],"sourcesContent":["import CodeMirror from 'codemirror';\nCodeMirror.defineOption('jump', false, (cm, options, old) => {\n    if (old && old !== CodeMirror.Init) {\n        const oldOnMouseOver = cm.state.jump.onMouseOver;\n        CodeMirror.off(cm.getWrapperElement(), 'mouseover', oldOnMouseOver);\n        const oldOnMouseOut = cm.state.jump.onMouseOut;\n        CodeMirror.off(cm.getWrapperElement(), 'mouseout', oldOnMouseOut);\n        CodeMirror.off(document, 'keydown', cm.state.jump.onKeyDown);\n        delete cm.state.jump;\n    }\n    if (options) {\n        const state = (cm.state.jump = {\n            options,\n            onMouseOver: onMouseOver.bind(null, cm),\n            onMouseOut: onMouseOut.bind(null, cm),\n            onKeyDown: onKeyDown.bind(null, cm),\n        });\n        CodeMirror.on(cm.getWrapperElement(), 'mouseover', state.onMouseOver);\n        CodeMirror.on(cm.getWrapperElement(), 'mouseout', state.onMouseOut);\n        CodeMirror.on(document, 'keydown', state.onKeyDown);\n    }\n});\nfunction onMouseOver(cm, event) {\n    const target = event.target || event.srcElement;\n    if (!(target instanceof HTMLElement)) {\n        return;\n    }\n    if ((target === null || target === void 0 ? void 0 : target.nodeName) !== 'SPAN') {\n        return;\n    }\n    const box = target.getBoundingClientRect();\n    const cursor = {\n        left: (box.left + box.right) / 2,\n        top: (box.top + box.bottom) / 2,\n    };\n    cm.state.jump.cursor = cursor;\n    if (cm.state.jump.isHoldingModifier) {\n        enableJumpMode(cm);\n    }\n}\nfunction onMouseOut(cm) {\n    if (!cm.state.jump.isHoldingModifier && cm.state.jump.cursor) {\n        cm.state.jump.cursor = null;\n        return;\n    }\n    if (cm.state.jump.isHoldingModifier && cm.state.jump.marker) {\n        disableJumpMode(cm);\n    }\n}\nfunction onKeyDown(cm, event) {\n    if (cm.state.jump.isHoldingModifier || !isJumpModifier(event.key)) {\n        return;\n    }\n    cm.state.jump.isHoldingModifier = true;\n    if (cm.state.jump.cursor) {\n        enableJumpMode(cm);\n    }\n    const onKeyUp = (upEvent) => {\n        if (upEvent.code !== event.code) {\n            return;\n        }\n        cm.state.jump.isHoldingModifier = false;\n        if (cm.state.jump.marker) {\n            disableJumpMode(cm);\n        }\n        CodeMirror.off(document, 'keyup', onKeyUp);\n        CodeMirror.off(document, 'click', onClick);\n        cm.off('mousedown', onMouseDown);\n    };\n    const onClick = (clickEvent) => {\n        const { destination, options } = cm.state.jump;\n        if (destination) {\n            options.onClick(destination, clickEvent);\n        }\n    };\n    const onMouseDown = (_, downEvent) => {\n        if (cm.state.jump.destination) {\n            downEvent.codemirrorIgnore = true;\n        }\n    };\n    CodeMirror.on(document, 'keyup', onKeyUp);\n    CodeMirror.on(document, 'click', onClick);\n    cm.on('mousedown', onMouseDown);\n}\nconst isMac = typeof navigator !== 'undefined' &&\n    navigator &&\n    navigator.appVersion.includes('Mac');\nfunction isJumpModifier(key) {\n    return key === (isMac ? 'Meta' : 'Control');\n}\nfunction enableJumpMode(cm) {\n    if (cm.state.jump.marker) {\n        return;\n    }\n    const { cursor, options } = cm.state.jump;\n    const pos = cm.coordsChar(cursor);\n    const token = cm.getTokenAt(pos, true);\n    const getDestination = options.getDestination || cm.getHelper(pos, 'jump');\n    if (getDestination) {\n        const destination = getDestination(token, options, cm);\n        if (destination) {\n            const marker = cm.markText({ line: pos.line, ch: token.start }, { line: pos.line, ch: token.end }, { className: 'CodeMirror-jump-token' });\n            cm.state.jump.marker = marker;\n            cm.state.jump.destination = destination;\n        }\n    }\n}\nfunction disableJumpMode(cm) {\n    const { marker } = cm.state.jump;\n    cm.state.jump.marker = null;\n    cm.state.jump.destination = null;\n    marker.clear();\n}\n//# sourceMappingURL=jump-addon.js.map","import CodeMirror from 'codemirror';\nimport getTypeInfo from './utils/getTypeInfo';\nimport { getArgumentReference, getDirectiveReference, getEnumValueReference, getFieldReference, getTypeReference, } from './utils/SchemaReference';\nimport './utils/jump-addon';\nCodeMirror.registerHelper('jump', 'graphql', (token, options) => {\n    if (!options.schema || !options.onClick || !token.state) {\n        return;\n    }\n    const { state } = token;\n    const { kind, step } = state;\n    const typeInfo = getTypeInfo(options.schema, state);\n    if ((kind === 'Field' && step === 0 && typeInfo.fieldDef) ||\n        (kind === 'AliasedField' && step === 2 && typeInfo.fieldDef)) {\n        return getFieldReference(typeInfo);\n    }\n    if (kind === 'Directive' && step === 1 && typeInfo.directiveDef) {\n        return getDirectiveReference(typeInfo);\n    }\n    if (kind === 'Argument' && step === 0 && typeInfo.argDef) {\n        return getArgumentReference(typeInfo);\n    }\n    if (kind === 'EnumValue' && typeInfo.enumValue) {\n        return getEnumValueReference(typeInfo);\n    }\n    if (kind === 'NamedType' && typeInfo.type) {\n        return getTypeReference(typeInfo);\n    }\n});\n//# sourceMappingURL=jump.js.map"],"names":["CodeMirror","cm","options","old","oldOnMouseOver","oldOnMouseOut","state","onMouseOver","onMouseOut","onKeyDown","event","target","box","cursor","enableJumpMode","__name","disableJumpMode","isJumpModifier","onKeyUp","upEvent","onClick","onMouseDown","clickEvent","destination","_","downEvent","isMac","key","pos","token","getDestination","marker","kind","step","typeInfo","getTypeInfo","getFieldReference","getDirectiveReference","getArgumentReference","getEnumValueReference","getTypeReference"],"mappings":"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"}