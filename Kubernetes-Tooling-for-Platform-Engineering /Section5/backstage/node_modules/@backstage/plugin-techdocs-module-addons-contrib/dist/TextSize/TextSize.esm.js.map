{"version":3,"file":"TextSize.esm.js","sources":["../../src/TextSize/TextSize.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, {\n  ChangeEvent,\n  MouseEvent,\n  useMemo,\n  useState,\n  useEffect,\n  useCallback,\n} from 'react';\n\nimport {\n  withStyles,\n  makeStyles,\n  useTheme,\n  Box,\n  MenuItem,\n  ListItemText,\n  Slider,\n  IconButton,\n  Typography,\n  Theme,\n} from '@material-ui/core';\nimport AddIcon from '@material-ui/icons/Add';\nimport RemoveIcon from '@material-ui/icons/Remove';\n\nimport { useShadowRootElements } from '@backstage/plugin-techdocs-react';\n\nconst boxShadow =\n  '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.13),0 0 0 1px rgba(0,0,0,0.02)';\n\nconst StyledSlider = withStyles(theme => ({\n  root: {\n    height: 2,\n    padding: '15px 0',\n  },\n  thumb: {\n    height: 18,\n    width: 18,\n    backgroundColor: theme.palette.common.white,\n    boxShadow: boxShadow,\n    marginTop: -9,\n    marginLeft: -9,\n    '&:focus, &:hover, &$active': {\n      boxShadow:\n        '0 3px 1px rgba(0,0,0,0.1),0 4px 8px rgba(0,0,0,0.3),0 0 0 1px rgba(0,0,0,0.02)',\n      // Reset on touch devices, it doesn't add specificity\n      '@media (hover: none)': {\n        boxShadow: boxShadow,\n      },\n    },\n  },\n  active: {},\n  valueLabel: {\n    top: '100%',\n    left: '50%',\n    transform: 'scale(1) translate(-50%, -5px) !important',\n    '& *': {\n      color: theme.palette.textSubtle,\n      fontSize: theme.typography.caption.fontSize,\n      background: 'transparent',\n    },\n  },\n  track: {\n    height: 2,\n  },\n  rail: {\n    height: 2,\n    opacity: 0.5,\n  },\n  mark: {\n    height: 10,\n    width: 1,\n    marginTop: -4,\n  },\n  markActive: {\n    opacity: 1,\n    backgroundColor: 'currentColor',\n  },\n}))(Slider);\n\nconst settings = {\n  key: 'techdocs.addons.settings.textsize',\n  defaultValue: 100,\n};\n\nconst marks = [\n  {\n    value: 90,\n  },\n  {\n    value: 100,\n  },\n  {\n    value: 115,\n  },\n  {\n    value: 130,\n  },\n  {\n    value: 150,\n  },\n];\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    color: theme.palette.textSubtle,\n    display: 'flex',\n    alignItems: 'center',\n    margin: 0,\n    minWidth: 200,\n  },\n  menuItem: {\n    '&:hover': {\n      background: 'transparent',\n    },\n  },\n  decreaseButton: {\n    marginRight: theme.spacing(1),\n  },\n  increaseButton: {\n    marginLeft: theme.spacing(1),\n  },\n}));\n\nexport const TextSizeAddon = () => {\n  const classes = useStyles();\n  const theme = useTheme();\n  const [body] = useShadowRootElements(['body']);\n\n  const [value, setValue] = useState<number>(() => {\n    const initialValue = localStorage?.getItem(settings.key);\n    return initialValue ? parseInt(initialValue, 10) : settings.defaultValue;\n  });\n\n  const values = useMemo(() => marks.map(mark => mark.value), []);\n  const index = useMemo(() => values.indexOf(value), [values, value]);\n  const min = useMemo(() => values[0], [values]);\n  const max = useMemo(() => values[values.length - 1], [values]);\n\n  const getValueText = useCallback(() => `${value}%`, [value]);\n\n  const handleChangeCommitted = useCallback(\n    (_event: ChangeEvent<{}>, newValue: number | number[]) => {\n      if (!Array.isArray(newValue)) {\n        setValue(newValue);\n        localStorage?.setItem(settings.key, String(newValue));\n      }\n    },\n    [setValue],\n  );\n\n  const handleDecreaseClick = useCallback(\n    (event: MouseEvent) => {\n      handleChangeCommitted(event, values[index - 1]);\n    },\n    [index, values, handleChangeCommitted],\n  );\n\n  const handleIncreaseClick = useCallback(\n    (event: MouseEvent) => {\n      handleChangeCommitted(event, values[index + 1]);\n    },\n    [index, values, handleChangeCommitted],\n  );\n\n  useEffect(() => {\n    if (!body) return;\n    const htmlFontSize =\n      (\n        theme.typography as Theme['typography'] & {\n          htmlFontSize?: number;\n        }\n      )?.htmlFontSize ?? 16;\n    body.style.setProperty(\n      '--md-typeset-font-size',\n      `${htmlFontSize * (value / 100)}px`,\n    );\n  }, [body, value, theme]);\n\n  return (\n    <MenuItem className={classes.menuItem} button disableRipple>\n      <ListItemText\n        primary={\n          <Typography variant=\"subtitle2\" color=\"textPrimary\">\n            Text size\n          </Typography>\n        }\n        secondary={\n          <Box className={classes.container}>\n            <IconButton\n              className={classes.decreaseButton}\n              size=\"small\"\n              edge=\"start\"\n              disabled={value === min}\n              onClick={handleDecreaseClick}\n              aria-label=\"Decrease text size\"\n            >\n              <RemoveIcon />\n            </IconButton>\n            <StyledSlider\n              value={value}\n              aria-labelledby=\"text-size-slider\"\n              getAriaValueText={getValueText}\n              valueLabelDisplay=\"on\"\n              valueLabelFormat={getValueText}\n              marks={marks}\n              step={null}\n              min={min}\n              max={max}\n              onChangeCommitted={handleChangeCommitted}\n            />\n            <IconButton\n              className={classes.increaseButton}\n              size=\"small\"\n              edge=\"end\"\n              disabled={value === max}\n              onClick={handleIncreaseClick}\n              aria-label=\"Increase text size\"\n            >\n              <AddIcon />\n            </IconButton>\n          </Box>\n        }\n        disableTypography\n      />\n    </MenuItem>\n  );\n};\n"],"names":[],"mappings":"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"}