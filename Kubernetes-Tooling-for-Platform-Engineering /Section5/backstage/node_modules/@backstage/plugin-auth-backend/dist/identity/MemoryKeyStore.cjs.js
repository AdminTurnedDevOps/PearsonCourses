'use strict';

var luxon = require('luxon');

class MemoryKeyStore {
  keys = /* @__PURE__ */ new Map();
  async addKey(key) {
    this.keys.set(key.kid, {
      createdAt: luxon.DateTime.utc().toJSDate(),
      key: JSON.stringify(key)
    });
  }
  async removeKeys(kids) {
    for (const kid of kids) {
      this.keys.delete(kid);
    }
  }
  async listKeys() {
    return {
      items: Array.from(this.keys).map(([, { createdAt, key: keyStr }]) => ({
        createdAt,
        key: JSON.parse(keyStr)
      }))
    };
  }
}

exports.MemoryKeyStore = MemoryKeyStore;
//# sourceMappingURL=MemoryKeyStore.cjs.js.map
