'use strict';

var errors = require('@backstage/errors');
var pluginPermissionCommon = require('@backstage/plugin-permission-common');

async function checkPermission(options) {
  const { permissions, permissionService, credentials } = options;
  if (permissionService) {
    const permissionRequest = permissions.map((permission) => ({
      permission
    }));
    const authorizationResponses = await permissionService.authorize(
      permissionRequest,
      { credentials }
    );
    for (const response of authorizationResponses) {
      if (response.result === pluginPermissionCommon.AuthorizeResult.DENY) {
        throw new errors.NotAllowedError();
      }
    }
  }
}

exports.checkPermission = checkPermission;
//# sourceMappingURL=checkPermissions.cjs.js.map
