{"version":3,"file":"FixDialog.esm.js","sources":["../../../../src/components/Pods/FixDialog/FixDialog.tsx"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React, { useState } from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport Grid from '@material-ui/core/Grid';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport IconButton from '@material-ui/core/IconButton';\nimport { makeStyles, createStyles, Theme } from '@material-ui/core/styles';\nimport Typography from '@material-ui/core/Typography';\nimport CloseIcon from '@material-ui/icons/Close';\nimport HelpIcon from '@material-ui/icons/Help';\nimport OpenInNewIcon from '@material-ui/icons/OpenInNew';\n\nimport { Pod } from 'kubernetes-models/v1/Pod';\nimport { DetectedError } from '@backstage/plugin-kubernetes-common';\nimport { PodLogs } from '../PodLogs';\nimport { Events } from '../Events';\nimport { LinkButton } from '@backstage/core-components';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    closeButton: {\n      position: 'absolute',\n      right: theme.spacing(1),\n      top: theme.spacing(1),\n      color: theme.palette.grey[500],\n    },\n  }),\n);\n\n/**\n * Props for FixDialog\n *\n * @public\n */\nexport interface FixDialogProps {\n  open?: boolean;\n  clusterName: string;\n  pod: Pod;\n  error: DetectedError;\n}\n\n/**\n * A dialog for fixing detected Kubernetes errors\n *\n * @public\n */\nexport const FixDialog: React.FC<FixDialogProps> = ({\n  open,\n  pod,\n  error,\n  clusterName,\n}: FixDialogProps) => {\n  const [isOpen, setOpen] = useState(!!open);\n  const classes = useStyles();\n\n  const openDialog = () => {\n    setOpen(true);\n  };\n\n  const closeDialog = () => {\n    setOpen(false);\n  };\n\n  const pf = error.proposedFix;\n\n  const dialogContent = () => {\n    return (\n      <Grid container>\n        <Grid item xs={12}>\n          <Typography variant=\"h6\">Detected error:</Typography>\n          <Typography>{error.message}</Typography>\n        </Grid>\n        <Grid item xs={12}>\n          <Typography variant=\"h6\">Cause explanation:</Typography>\n          <Typography>\n            {error.proposedFix?.rootCauseExplanation ?? 'unknown'}\n          </Typography>\n        </Grid>\n        <Grid item xs={12}>\n          <Typography variant=\"h6\">Fix:</Typography>\n          <List>\n            {(error.proposedFix?.actions ?? []).map((fix, i) => {\n              return (\n                <ListItem key={`${pod.metadata?.name ?? 'unknown'}-pf-${i}`}>\n                  {fix}\n                </ListItem>\n              );\n            })}\n          </List>\n        </Grid>\n\n        {pf && pf.type === 'logs' && (\n          <>\n            <Grid item xs={12}>\n              <Typography variant=\"h6\">Crash logs:</Typography>\n            </Grid>\n            <Grid item xs={9}>\n              <PodLogs\n                previous\n                containerScope={{\n                  podName: pod.metadata?.name ?? 'unknown',\n                  podNamespace: pod.metadata?.namespace ?? 'unknown',\n                  cluster: { name: clusterName },\n                  containerName: pf.container,\n                }}\n              />\n            </Grid>\n          </>\n        )}\n        {pf && pf.type === 'events' && (\n          <>\n            <Grid item xs={12}>\n              <Typography variant=\"h6\">Events:</Typography>\n            </Grid>\n            <Grid item xs={9}>\n              <Events\n                warningEventsOnly\n                involvedObjectName={pod.metadata?.name ?? ''}\n                namespace={pod.metadata?.namespace ?? ''}\n                clusterName={clusterName}\n              />\n            </Grid>\n          </>\n        )}\n      </Grid>\n    );\n  };\n\n  return (\n    <>\n      <Button\n        variant=\"outlined\"\n        aria-label=\"fix issue\"\n        component=\"label\"\n        onClick={openDialog}\n        startIcon={<HelpIcon />}\n      >\n        Help\n      </Button>\n      <Dialog maxWidth=\"xl\" fullWidth open={isOpen} onClose={closeDialog}>\n        <DialogTitle id=\"dialog-title\">\n          {pod.metadata?.name} - {error.type}\n          <IconButton\n            aria-label=\"close\"\n            className={classes.closeButton}\n            onClick={closeDialog}\n          >\n            <CloseIcon />\n          </IconButton>\n        </DialogTitle>\n        <DialogContent>{dialogContent()}</DialogContent>\n        <DialogActions>\n          {pf && pf.type === 'docs' && (\n            <LinkButton\n              to={pf.docsLink}\n              variant=\"outlined\"\n              startIcon={<OpenInNewIcon />}\n              target=\"_blank\"\n              rel=\"noopener\"\n            >\n              Open docs\n            </LinkButton>\n          )}\n        </DialogActions>\n      </Dialog>\n    </>\n  );\n};\n"],"names":["React"],"mappings":"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"}