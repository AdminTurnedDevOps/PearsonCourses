{"version":3,"file":"hasLabel.cjs.js","sources":["../../../src/permissions/rules/hasLabel.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { RESOURCE_TYPE_CATALOG_ENTITY } from '@backstage/plugin-catalog-common/alpha';\nimport { z } from 'zod';\nimport { createCatalogPermissionRule } from './util';\n\n/**\n * A catalog {@link @backstage/plugin-permission-node#PermissionRule} which\n * filters for entities with a specified label in its metadata.\n * @alpha\n */\nexport const hasLabel = createCatalogPermissionRule({\n  name: 'HAS_LABEL',\n  description: 'Allow entities with the specified label',\n  resourceType: RESOURCE_TYPE_CATALOG_ENTITY,\n  paramsSchema: z.object({\n    label: z.string().describe('Name of the label to match on'),\n  }),\n  apply: (resource, { label }) =>\n    !!resource.metadata.labels?.hasOwnProperty(label),\n  toQuery: ({ label }) => ({\n    key: `metadata.labels.${label}`,\n  }),\n});\n"],"names":["createCatalogPermissionRule","RESOURCE_TYPE_CATALOG_ENTITY","z"],"mappings":";;;;;;AAyBO,MAAM,WAAWA,gCAA4B,CAAA;AAAA,EAClD,IAAM,EAAA,WAAA;AAAA,EACN,WAAa,EAAA,yCAAA;AAAA,EACb,YAAc,EAAAC,kCAAA;AAAA,EACd,YAAA,EAAcC,MAAE,MAAO,CAAA;AAAA,IACrB,KAAO,EAAAA,KAAA,CAAE,MAAO,EAAA,CAAE,SAAS,+BAA+B;AAAA,GAC3D,CAAA;AAAA,EACD,KAAO,EAAA,CAAC,QAAU,EAAA,EAAE,KAAM,EAAA,KACxB,CAAC,CAAC,QAAS,CAAA,QAAA,CAAS,MAAQ,EAAA,cAAA,CAAe,KAAK,CAAA;AAAA,EAClD,OAAS,EAAA,CAAC,EAAE,KAAA,EAAa,MAAA;AAAA,IACvB,GAAA,EAAK,mBAAmB,KAAK,CAAA;AAAA,GAC/B;AACF,CAAC;;;;"}