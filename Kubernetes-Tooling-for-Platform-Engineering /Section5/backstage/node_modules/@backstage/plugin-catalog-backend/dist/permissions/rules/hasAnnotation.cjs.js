'use strict';

var alpha = require('@backstage/plugin-catalog-common/alpha');
var zod = require('zod');
var util = require('./util.cjs.js');

const hasAnnotation = util.createCatalogPermissionRule({
  name: "HAS_ANNOTATION",
  description: "Allow entities with the specified annotation",
  resourceType: alpha.RESOURCE_TYPE_CATALOG_ENTITY,
  paramsSchema: zod.z.object({
    annotation: zod.z.string().describe("Name of the annotation to match on"),
    value: zod.z.string().optional().describe("Value of the annotation to match on")
  }),
  apply: (resource, { annotation, value }) => !!resource.metadata.annotations?.hasOwnProperty(annotation) && (value === void 0 ? true : resource.metadata.annotations?.[annotation] === value),
  toQuery: ({ annotation, value }) => value === void 0 ? {
    key: `metadata.annotations.${annotation}`
  } : {
    key: `metadata.annotations.${annotation}`,
    values: [value]
  }
});

exports.hasAnnotation = hasAnnotation;
//# sourceMappingURL=hasAnnotation.cjs.js.map
