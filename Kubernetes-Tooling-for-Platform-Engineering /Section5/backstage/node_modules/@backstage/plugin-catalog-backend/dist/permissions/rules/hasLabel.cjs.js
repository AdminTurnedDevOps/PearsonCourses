'use strict';

var alpha = require('@backstage/plugin-catalog-common/alpha');
var zod = require('zod');
var util = require('./util.cjs.js');

const hasLabel = util.createCatalogPermissionRule({
  name: "HAS_LABEL",
  description: "Allow entities with the specified label",
  resourceType: alpha.RESOURCE_TYPE_CATALOG_ENTITY,
  paramsSchema: zod.z.object({
    label: zod.z.string().describe("Name of the label to match on")
  }),
  apply: (resource, { label }) => !!resource.metadata.labels?.hasOwnProperty(label),
  toQuery: ({ label }) => ({
    key: `metadata.labels.${label}`
  })
});

exports.hasLabel = hasLabel;
//# sourceMappingURL=hasLabel.cjs.js.map
