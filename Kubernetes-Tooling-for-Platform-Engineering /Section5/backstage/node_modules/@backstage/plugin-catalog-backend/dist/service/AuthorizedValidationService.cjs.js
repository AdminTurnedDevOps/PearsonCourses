'use strict';

var errors = require('@backstage/errors');
var alpha = require('@backstage/plugin-catalog-common/alpha');
var pluginPermissionCommon = require('@backstage/plugin-permission-common');

class AuthorizedValidationService {
  constructor(service, permissionApi) {
    this.service = service;
    this.permissionApi = permissionApi;
  }
  async process(request, credentials) {
    const authorizeDecision = (await this.permissionApi.authorize(
      [
        {
          permission: alpha.catalogEntityValidatePermission
        }
      ],
      { credentials }
    ))[0];
    if (authorizeDecision.result !== pluginPermissionCommon.AuthorizeResult.ALLOW) {
      throw new errors.NotAllowedError();
    }
    return this.service.process(request);
  }
}

exports.AuthorizedValidationService = AuthorizedValidationService;
//# sourceMappingURL=AuthorizedValidationService.cjs.js.map
