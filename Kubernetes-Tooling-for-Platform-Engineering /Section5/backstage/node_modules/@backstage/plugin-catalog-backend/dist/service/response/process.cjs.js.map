{"version":3,"file":"process.cjs.js","sources":["../../../src/service/response/process.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport { EntitiesResponseItems } from '../../catalog/types';\n\nexport function processRawEntitiesResult(\n  serializedEntities: (string | null)[],\n  transform?: (entity: Entity) => Entity,\n): EntitiesResponseItems {\n  if (transform) {\n    return {\n      type: 'object',\n      entities: serializedEntities.map(e =>\n        e !== null ? transform(JSON.parse(e)) : e,\n      ),\n    };\n  }\n\n  return {\n    type: 'raw',\n    entities: serializedEntities,\n  };\n}\n\nexport function processEntitiesResponseItems(\n  response: EntitiesResponseItems,\n  transform?: (entity: Entity) => Entity,\n): EntitiesResponseItems {\n  if (!transform) {\n    return response;\n  }\n  if (response.type === 'raw') {\n    return processRawEntitiesResult(response.entities, transform);\n  }\n  return {\n    type: 'object',\n    entities: response.entities.map(e => (e !== null ? transform(e) : e)),\n  };\n}\n\nexport function entitiesResponseToObjects(\n  response: EntitiesResponseItems,\n): (Entity | null)[] {\n  if (response.type === 'object') {\n    return response.entities;\n  }\n  return response.entities.map(e => (e !== null ? JSON.parse(e) : e));\n}\n"],"names":[],"mappings":";;AAmBgB,SAAA,wBAAA,CACd,oBACA,SACuB,EAAA;AACvB,EAAA,IAAI,SAAW,EAAA;AACb,IAAO,OAAA;AAAA,MACL,IAAM,EAAA,QAAA;AAAA,MACN,UAAU,kBAAmB,CAAA,GAAA;AAAA,QAAI,CAAA,CAAA,KAC/B,MAAM,IAAO,GAAA,SAAA,CAAU,KAAK,KAAM,CAAA,CAAC,CAAC,CAAI,GAAA;AAAA;AAC1C,KACF;AAAA;AAGF,EAAO,OAAA;AAAA,IACL,IAAM,EAAA,KAAA;AAAA,IACN,QAAU,EAAA;AAAA,GACZ;AACF;AAEgB,SAAA,4BAAA,CACd,UACA,SACuB,EAAA;AACvB,EAAA,IAAI,CAAC,SAAW,EAAA;AACd,IAAO,OAAA,QAAA;AAAA;AAET,EAAI,IAAA,QAAA,CAAS,SAAS,KAAO,EAAA;AAC3B,IAAO,OAAA,wBAAA,CAAyB,QAAS,CAAA,QAAA,EAAU,SAAS,CAAA;AAAA;AAE9D,EAAO,OAAA;AAAA,IACL,IAAM,EAAA,QAAA;AAAA,IACN,QAAA,EAAU,QAAS,CAAA,QAAA,CAAS,GAAI,CAAA,CAAA,CAAA,KAAM,MAAM,IAAO,GAAA,SAAA,CAAU,CAAC,CAAA,GAAI,CAAE;AAAA,GACtE;AACF;AAEO,SAAS,0BACd,QACmB,EAAA;AACnB,EAAI,IAAA,QAAA,CAAS,SAAS,QAAU,EAAA;AAC9B,IAAA,OAAO,QAAS,CAAA,QAAA;AAAA;AAElB,EAAO,OAAA,QAAA,CAAS,QAAS,CAAA,GAAA,CAAI,CAAM,CAAA,KAAA,CAAA,KAAM,OAAO,IAAK,CAAA,KAAA,CAAM,CAAC,CAAA,GAAI,CAAE,CAAA;AACpE;;;;;;"}