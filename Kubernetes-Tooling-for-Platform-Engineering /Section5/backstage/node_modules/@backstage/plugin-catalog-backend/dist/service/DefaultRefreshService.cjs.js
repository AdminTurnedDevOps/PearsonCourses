'use strict';

class DefaultRefreshService {
  database;
  constructor(options) {
    this.database = options.database;
  }
  async refresh(options) {
    await this.database.transaction(async (tx) => {
      const { entityRefs } = await this.database.listAncestors(tx, {
        entityRef: options.entityRef
      });
      const locationAncestor = entityRefs.find(
        (ref) => ref.startsWith("location:")
      );
      if (locationAncestor) {
        await this.database.refresh(tx, {
          entityRef: locationAncestor
        });
      }
      await this.database.refresh(tx, {
        entityRef: options.entityRef
      });
    });
  }
}

exports.DefaultRefreshService = DefaultRefreshService;
//# sourceMappingURL=DefaultRefreshService.cjs.js.map
