{"version":3,"file":"useSupportConfig.esm.js","sources":["../../src/hooks/useSupportConfig.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useApiHolder, configApiRef } from '@backstage/core-plugin-api';\nimport { coreComponentsTranslationRef } from '../translation';\nimport { useTranslationRef } from '@backstage/core-plugin-api/alpha';\n\nexport type SupportItemLink = {\n  url: string;\n  title: string;\n};\n\nexport type SupportItem = {\n  title: string;\n  icon?: string;\n  links: SupportItemLink[];\n};\n\nexport type SupportConfig = {\n  url: string;\n  items: SupportItem[];\n};\n\nconst useDefaultSupportConfig = () => {\n  const { t } = useTranslationRef(coreComponentsTranslationRef);\n  return {\n    url: 'https://github.com/backstage/backstage/issues',\n    items: [\n      {\n        title: t('supportConfig.default.title'),\n        icon: 'warning',\n        links: [\n          {\n            // TODO: Update to dedicated support page on backstage.io/docs\n            title: t('supportConfig.default.linkTitle'),\n            url: 'https://github.com/backstage/backstage/blob/master/app-config.yaml',\n          },\n        ],\n      },\n    ],\n  };\n};\n\nexport function useSupportConfig(): SupportConfig {\n  const apiHolder = useApiHolder();\n  const config = apiHolder.get(configApiRef);\n  const supportConfig = config?.getOptionalConfig('app.support');\n  const defaultSupportConfig = useDefaultSupportConfig();\n\n  if (!supportConfig) {\n    return defaultSupportConfig;\n  }\n\n  return {\n    url: supportConfig.getString('url'),\n    items: supportConfig.getConfigArray('items').flatMap(itemConf => ({\n      title: itemConf.getString('title'),\n      icon: itemConf.getOptionalString('icon'),\n      links: (itemConf.getOptionalConfigArray('links') ?? []).flatMap(\n        linkConf => ({\n          url: linkConf.getString('url'),\n          title: linkConf.getOptionalString('title') ?? '',\n        }),\n      ),\n    })),\n  };\n}\n"],"names":[],"mappings":";;;;AAoCA,MAAM,0BAA0B,MAAM;AACpC,EAAA,MAAM,EAAE,CAAA,EAAM,GAAA,iBAAA,CAAkB,4BAA4B,CAAA;AAC5D,EAAO,OAAA;AAAA,IACL,GAAK,EAAA,+CAAA;AAAA,IACL,KAAO,EAAA;AAAA,MACL;AAAA,QACE,KAAA,EAAO,EAAE,6BAA6B,CAAA;AAAA,QACtC,IAAM,EAAA,SAAA;AAAA,QACN,KAAO,EAAA;AAAA,UACL;AAAA;AAAA,YAEE,KAAA,EAAO,EAAE,iCAAiC,CAAA;AAAA,YAC1C,GAAK,EAAA;AAAA;AACP;AACF;AACF;AACF,GACF;AACF,CAAA;AAEO,SAAS,gBAAkC,GAAA;AAChD,EAAA,MAAM,YAAY,YAAa,EAAA;AAC/B,EAAM,MAAA,MAAA,GAAS,SAAU,CAAA,GAAA,CAAI,YAAY,CAAA;AACzC,EAAM,MAAA,aAAA,GAAgB,MAAQ,EAAA,iBAAA,CAAkB,aAAa,CAAA;AAC7D,EAAA,MAAM,uBAAuB,uBAAwB,EAAA;AAErD,EAAA,IAAI,CAAC,aAAe,EAAA;AAClB,IAAO,OAAA,oBAAA;AAAA;AAGT,EAAO,OAAA;AAAA,IACL,GAAA,EAAK,aAAc,CAAA,SAAA,CAAU,KAAK,CAAA;AAAA,IAClC,OAAO,aAAc,CAAA,cAAA,CAAe,OAAO,CAAA,CAAE,QAAQ,CAAa,QAAA,MAAA;AAAA,MAChE,KAAA,EAAO,QAAS,CAAA,SAAA,CAAU,OAAO,CAAA;AAAA,MACjC,IAAA,EAAM,QAAS,CAAA,iBAAA,CAAkB,MAAM,CAAA;AAAA,MACvC,QAAQ,QAAS,CAAA,sBAAA,CAAuB,OAAO,CAAA,IAAK,EAAI,EAAA,OAAA;AAAA,QACtD,CAAa,QAAA,MAAA;AAAA,UACX,GAAA,EAAK,QAAS,CAAA,SAAA,CAAU,KAAK,CAAA;AAAA,UAC7B,KAAO,EAAA,QAAA,CAAS,iBAAkB,CAAA,OAAO,CAAK,IAAA;AAAA,SAChD;AAAA;AACF,KACA,CAAA;AAAA,GACJ;AACF;;;;"}