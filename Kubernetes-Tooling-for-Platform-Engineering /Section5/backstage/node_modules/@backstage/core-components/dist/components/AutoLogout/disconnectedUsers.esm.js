import { useEffect } from 'react';

const LAST_SEEN_ONLINE_STORAGE_KEY = "@backstage/autologout:lastSeenOnline";
const useLogoutDisconnectedUserEffect = ({
  enableEffect,
  autologoutIsEnabled,
  idleTimeoutSeconds,
  lastSeenOnlineStore,
  identityApi
}) => {
  useEffect(() => {
    if (autologoutIsEnabled && enableEffect) {
      const lastSeenOnline = lastSeenOnlineStore.get();
      if (lastSeenOnline) {
        const now = /* @__PURE__ */ new Date();
        const nowSeconds = Math.ceil(now.getTime() / 1e3);
        const lastSeenOnlineSeconds = Math.ceil(
          lastSeenOnline.getTime() / 1e3
        );
        if (nowSeconds - lastSeenOnlineSeconds > idleTimeoutSeconds) {
          identityApi.signOut();
        }
      }
      lastSeenOnlineStore.save(/* @__PURE__ */ new Date());
    } else {
      lastSeenOnlineStore.delete();
    }
  }, [
    autologoutIsEnabled,
    enableEffect,
    identityApi,
    idleTimeoutSeconds,
    lastSeenOnlineStore
  ]);
};

export { LAST_SEEN_ONLINE_STORAGE_KEY, useLogoutDisconnectedUserEffect };
//# sourceMappingURL=disconnectedUsers.esm.js.map
