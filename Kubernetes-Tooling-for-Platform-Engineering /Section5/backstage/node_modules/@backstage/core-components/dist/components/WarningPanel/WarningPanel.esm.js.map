{"version":3,"file":"WarningPanel.esm.js","sources":["../../../src/components/WarningPanel/WarningPanel.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { makeStyles, darken, lighten, Theme } from '@material-ui/core/styles';\nimport Accordion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport ErrorOutline from '@material-ui/icons/ErrorOutline';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport React from 'react';\nimport { MarkdownContent } from '../MarkdownContent';\n\nconst getWarningTextColor = (\n  severity: NonNullable<WarningProps['severity']>,\n  theme: Theme,\n) => {\n  const getColor = theme.palette.type === 'light' ? darken : lighten;\n  return getColor(theme.palette[severity].light, 0.6);\n};\n\nconst getWarningBackgroundColor = (\n  severity: NonNullable<WarningProps['severity']>,\n  theme: Theme,\n) => {\n  const getBackgroundColor = theme.palette.type === 'light' ? lighten : darken;\n  return getBackgroundColor(theme.palette[severity].light, 0.9);\n};\n\nconst useErrorOutlineStyles = makeStyles(theme => ({\n  root: {\n    marginRight: theme.spacing(1),\n    fill: ({ severity }: WarningProps) =>\n      getWarningTextColor(\n        severity as NonNullable<WarningProps['severity']>,\n        theme,\n      ),\n  },\n}));\n\nconst ErrorOutlineStyled = ({ severity }: Pick<WarningProps, 'severity'>) => {\n  const classes = useErrorOutlineStyles({ severity });\n  return <ErrorOutline classes={classes} />;\n};\nconst ExpandMoreIconStyled = ({ severity }: Pick<WarningProps, 'severity'>) => {\n  const classes = useErrorOutlineStyles({ severity });\n  return <ExpandMoreIcon classes={classes} />;\n};\n\nexport type WarningPanelClassKey =\n  | 'panel'\n  | 'summary'\n  | 'summaryText'\n  | 'message'\n  | 'details';\n\nconst useStyles = makeStyles(\n  theme => ({\n    panel: {\n      backgroundColor: ({ severity }: WarningProps) =>\n        getWarningBackgroundColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      verticalAlign: 'middle',\n    },\n    summary: {\n      display: 'flex',\n      flexDirection: 'row',\n    },\n    summaryText: {\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      fontWeight: theme.typography.fontWeightBold,\n    },\n    markdownContent: {\n      '& p': {\n        display: 'inline',\n      },\n    },\n    message: {\n      width: '100%',\n      display: 'block',\n      color: ({ severity }: WarningProps) =>\n        getWarningTextColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n      backgroundColor: ({ severity }: WarningProps) =>\n        getWarningBackgroundColor(\n          severity as NonNullable<WarningProps['severity']>,\n          theme,\n        ),\n    },\n    details: {\n      width: '100%',\n      display: 'block',\n      color: theme.palette.textContrast,\n      backgroundColor: theme.palette.background.default,\n      border: `1px solid ${theme.palette.border}`,\n      padding: theme.spacing(2.0),\n      fontFamily: 'sans-serif',\n    },\n  }),\n  { name: 'BackstageWarningPanel' },\n);\n\nexport type WarningProps = {\n  title?: string;\n  severity?: 'warning' | 'error' | 'info';\n  titleFormat?: string;\n  message?: React.ReactNode;\n  defaultExpanded?: boolean;\n  children?: React.ReactNode;\n};\n\nconst capitalize = (s: string) => {\n  return s.charAt(0).toLocaleUpperCase('en-US') + s.slice(1);\n};\n\n/**\n * Show a user friendly error message to a user similar to\n * ErrorPanel except that the warning panel only shows the warning message to\n * the user.\n *\n * @param severity - Ability to change the severity of the alert. Default value\n *        \"warning\"\n * @param title - A title for the warning. If not supplied, \"Warning\" will be\n *        used.\n * @param message - Optional more detailed user-friendly message elaborating on\n *        the cause of the error.\n * @param children - Objects to provide context, such as a stack trace or detailed\n *        error reporting. Will be available inside an unfolded accordion.\n */\nexport function WarningPanel(props: WarningProps) {\n  const {\n    severity = 'warning',\n    title,\n    titleFormat,\n    message,\n    children,\n    defaultExpanded,\n  } = props;\n  const classes = useStyles({ severity });\n\n  // If no severity or title provided, the heading will read simply \"Warning\"\n  const subTitle = capitalize(severity) + (title ? `: ${title}` : '');\n\n  return (\n    <Accordion\n      defaultExpanded={defaultExpanded ?? false}\n      className={classes.panel}\n      role=\"alert\"\n    >\n      <AccordionSummary\n        expandIcon={<ExpandMoreIconStyled severity={severity} />}\n        className={classes.summary}\n      >\n        <ErrorOutlineStyled severity={severity} />\n        <Typography className={classes.summaryText} variant=\"subtitle1\">\n          {titleFormat === 'markdown' ? (\n            <MarkdownContent\n              content={subTitle}\n              className={classes.markdownContent}\n            />\n          ) : (\n            subTitle\n          )}\n        </Typography>\n      </AccordionSummary>\n      {(message || children) && (\n        <AccordionDetails>\n          <Grid container>\n            {message && (\n              <Grid item xs={12}>\n                <Typography className={classes.message} variant=\"body1\">\n                  {message}\n                </Typography>\n              </Grid>\n            )}\n            {children && (\n              <Grid item xs={12} className={classes.details}>\n                {children}\n              </Grid>\n            )}\n          </Grid>\n        </AccordionDetails>\n      )}\n    </Accordion>\n  );\n}\n"],"names":["React"],"mappings":"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"}