{"version":3,"file":"HorizontalScrollGrid.esm.js","sources":["../../../src/components/HorizontalScrollGrid/HorizontalScrollGrid.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport Box from '@material-ui/core/Box';\nimport Grid from '@material-ui/core/Grid';\nimport IconButton from '@material-ui/core/IconButton';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport classNames from 'classnames';\nimport React, { PropsWithChildren } from 'react';\n\nconst generateGradientStops = (themeType: 'dark' | 'light') => {\n  // 97% corresponds to the theme.palette.background.default for the light theme\n  // 16% for the dark theme\n  const luminance = themeType === 'dark' ? '16%' : '97%';\n  // Generated with https://larsenwork.com/easing-gradients/\n  return `\n    hsl(0, 0%, ${luminance}) 0%,\n    hsla(0, 0%, ${luminance}, 0.987) 8.1%,\n    hsla(0, 0%, ${luminance}, 0.951) 15.5%,\n    hsla(0, 0%, ${luminance}, 0.896) 22.5%,\n    hsla(0, 0%, ${luminance}, 0.825) 29%,\n    hsla(0, 0%, ${luminance}, 0.741) 35.3%,\n    hsla(0, 0%, ${luminance}, 0.648) 41.2%,\n    hsla(0, 0%, ${luminance}, 0.55) 47.1%,\n    hsla(0, 0%, ${luminance}, 0.45) 52.9%,\n    hsla(0, 0%, ${luminance}, 0.352) 58.8%,\n    hsla(0, 0%, ${luminance}, 0.259) 64.7%,\n    hsla(0, 0%, ${luminance}, 0.175) 71%,\n    hsla(0, 0%, ${luminance}, 0.104) 77.5%,\n    hsla(0, 0%, ${luminance}, 0.049) 84.5%,\n    hsla(0, 0%, ${luminance}, 0.013) 91.9%,\n    hsla(0, 0%, ${luminance}, 0) 100%\n  `;\n};\n\nconst fadeSize = 100;\nconst fadePadding = 10;\n\ntype Props = {\n  scrollStep?: number;\n  scrollSpeed?: number; // lower is faster\n  minScrollDistance?: number; // limits how small steps the scroll can take in px\n};\n\n/** @public */\nexport type HorizontalScrollGridClassKey =\n  | 'root'\n  | 'container'\n  | 'fade'\n  | 'fadeLeft'\n  | 'fadeRight'\n  | 'fadeHidden'\n  | 'button'\n  | 'buttonLeft'\n  | 'buttonRight';\n\nconst useStyles = makeStyles(\n  theme => ({\n    root: {\n      position: 'relative',\n      display: 'flex',\n      flexFlow: 'row nowrap',\n      alignItems: 'center',\n    },\n    container: {\n      overflow: 'auto',\n      scrollbarWidth: 0 as any, // hide in FF\n      '&::-webkit-scrollbar': {\n        display: 'none', // hide in Chrome\n      },\n    },\n    fade: {\n      position: 'absolute',\n      width: fadeSize,\n      height: `calc(100% + ${fadePadding}px)`,\n      transition: 'opacity 300ms',\n      pointerEvents: 'none',\n    },\n    fadeLeft: {\n      left: -fadePadding,\n      background: `linear-gradient(90deg, ${generateGradientStops(\n        theme.palette.type,\n      )})`,\n    },\n    fadeRight: {\n      right: -fadePadding,\n      background: `linear-gradient(270deg, ${generateGradientStops(\n        theme.palette.type,\n      )})`,\n    },\n    fadeHidden: {\n      opacity: 0,\n    },\n    button: {\n      position: 'absolute',\n    },\n    buttonLeft: {\n      left: -theme.spacing(2),\n    },\n    buttonRight: {\n      right: -theme.spacing(2),\n    },\n  }),\n  { name: 'BackstageHorizontalScrollGrid' },\n);\n\n// Returns scroll distance from left and right\nfunction useScrollDistance(\n  ref: React.MutableRefObject<HTMLElement | undefined>,\n): [number, number] {\n  const [[scrollLeft, scrollRight], setScroll] = React.useState<\n    [number, number]\n  >([0, 0]);\n\n  React.useLayoutEffect(() => {\n    const el = ref.current;\n    if (!el) {\n      setScroll([0, 0]);\n      return;\n    }\n\n    const handleUpdate = () => {\n      const left = el.scrollLeft;\n      const right = el.scrollWidth - el.offsetWidth - el.scrollLeft;\n      setScroll([left, right]);\n    };\n\n    handleUpdate();\n\n    el.addEventListener('scroll', handleUpdate);\n    window.addEventListener('resize', handleUpdate);\n    // TODO(freben): Remove this eslint exception later\n    // It's here because @types/react-router-dom v5 pulls in @types/react that have the wrong signature\n    // eslint-disable-next-line consistent-return\n    return () => {\n      el.removeEventListener('scroll', handleUpdate);\n      window.removeEventListener('resize', handleUpdate);\n    };\n  }, [ref]);\n\n  return [scrollLeft, scrollRight];\n}\n\n// Used to animate scrolling. Returns a single setScrollTarget function, when called with e.g. 200,\n// the element pointer to by the ref will be scrolled 200px forwards over time.\nfunction useSmoothScroll(\n  ref: React.MutableRefObject<HTMLElement | undefined>,\n  speed: number,\n  minDistance: number,\n) {\n  const [scrollTarget, setScrollTarget] = React.useState<number>(0);\n\n  React.useLayoutEffect(() => {\n    if (scrollTarget === 0) {\n      return;\n    }\n\n    const startTime = window.performance.now();\n    const id = requestAnimationFrame(frameTime => {\n      if (!ref.current) {\n        return;\n      }\n      const frameDuration = frameTime - startTime;\n      const scrollDistance = (Math.abs(scrollTarget) * frameDuration) / speed;\n      const cappedScrollDistance = Math.max(minDistance, scrollDistance);\n      const scrollAmount = cappedScrollDistance * Math.sign(scrollTarget);\n\n      ref.current.scrollBy({ left: scrollAmount });\n\n      const newScrollTarget = scrollTarget - scrollAmount;\n      if (Math.sign(scrollTarget) !== Math.sign(newScrollTarget)) {\n        setScrollTarget(0);\n      } else {\n        setScrollTarget(newScrollTarget);\n      }\n    });\n\n    // TODO(freben): Remove this eslint exception later\n    // It's here because @types/react-router-dom v5 pulls in @types/react that have the wrong signature\n    // eslint-disable-next-line consistent-return\n    return () => cancelAnimationFrame(id);\n  }, [ref, scrollTarget, speed, minDistance]);\n\n  return setScrollTarget;\n}\n\n/**\n * Horizontal scrollable component with arrows to navigate\n *\n * @public\n *\n */\nexport function HorizontalScrollGrid(props: PropsWithChildren<Props>) {\n  const {\n    scrollStep = 100,\n    scrollSpeed = 50,\n    minScrollDistance = 5,\n    children,\n    ...otherProps\n  } = props;\n  const classes = useStyles(props);\n  const ref = React.useRef<HTMLElement>();\n\n  const [scrollLeft, scrollRight] = useScrollDistance(ref);\n  const setScrollTarget = useSmoothScroll(ref, scrollSpeed, minScrollDistance);\n\n  const handleScrollClick = (forwards: boolean) => {\n    const el = ref.current;\n    if (!el) {\n      return;\n    }\n    setScrollTarget(forwards ? scrollStep : -scrollStep);\n  };\n\n  return (\n    <Box {...otherProps} className={classes.root}>\n      <Grid\n        container\n        direction=\"row\"\n        wrap=\"nowrap\"\n        className={classes.container}\n        ref={ref as any}\n      >\n        {children}\n      </Grid>\n      <Box\n        className={classNames(classes.fade, classes.fadeLeft, {\n          [classes.fadeHidden]: scrollLeft === 0,\n        })}\n      />\n      <Box\n        className={classNames(classes.fade, classes.fadeRight, {\n          [classes.fadeHidden]: scrollRight === 0,\n        })}\n      />\n      {scrollLeft > 0 && (\n        <IconButton\n          title=\"Scroll Left\"\n          onClick={() => handleScrollClick(false)}\n          className={classNames(classes.button, classes.buttonLeft, {})}\n        >\n          <ChevronLeftIcon />\n        </IconButton>\n      )}\n      {scrollRight > 0 && (\n        <IconButton\n          title=\"Scroll Right\"\n          onClick={() => handleScrollClick(true)}\n          className={classNames(classes.button, classes.buttonRight, {})}\n        >\n          <ChevronRightIcon />\n        </IconButton>\n      )}\n    </Box>\n  );\n}\n"],"names":["React","ChevronRightIcon"],"mappings":"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"}