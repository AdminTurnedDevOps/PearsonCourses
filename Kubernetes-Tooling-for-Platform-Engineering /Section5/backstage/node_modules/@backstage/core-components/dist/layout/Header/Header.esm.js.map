{"version":3,"file":"Header.esm.js","sources":["../../../src/layout/Header/Header.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { configApiRef, useApi } from '@backstage/core-plugin-api';\nimport Box from '@material-ui/core/Box';\nimport Grid from '@material-ui/core/Grid';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport Typography from '@material-ui/core/Typography';\nimport React, { CSSProperties, PropsWithChildren, ReactNode } from 'react';\nimport { Helmet } from 'react-helmet';\nimport { Link } from '../../components/Link';\nimport { Breadcrumbs } from '../Breadcrumbs';\nimport { useContent } from '../Sidebar';\n\n/** @public */\nexport type HeaderClassKey =\n  | 'header'\n  | 'leftItemsBox'\n  | 'rightItemsBox'\n  | 'title'\n  | 'subtitle'\n  | 'type'\n  | 'breadcrumb'\n  | 'breadcrumbType'\n  | 'breadcrumbTitle';\n\nconst useStyles = makeStyles(\n  theme => ({\n    header: {\n      gridArea: 'pageHeader',\n      padding: theme.spacing(3),\n      width: '100%',\n      boxShadow: theme.shadows[4],\n      position: 'relative',\n      zIndex: 100,\n      display: 'flex',\n      flexDirection: 'row',\n      alignItems: 'center',\n      backgroundImage: theme.page.backgroundImage,\n      backgroundPosition: 'center',\n      backgroundSize: 'cover',\n      [theme.breakpoints.down('sm')]: {\n        flexWrap: 'wrap',\n      },\n    },\n    leftItemsBox: {\n      maxWidth: '100%',\n      flexGrow: 1,\n    },\n    rightItemsBox: {\n      width: 'auto',\n      alignItems: 'center',\n    },\n    title: {\n      color: theme.page.fontColor,\n      wordBreak: 'break-word',\n      fontSize: theme.typography.h3.fontSize,\n      marginBottom: 0,\n    },\n    subtitle: {\n      color: theme.page.fontColor,\n      opacity: 0.8,\n      display: 'inline-block', // prevents margin collapse of adjacent siblings\n      marginTop: theme.spacing(1),\n      maxWidth: '75ch',\n    },\n    type: {\n      textTransform: 'uppercase',\n      fontSize: 11,\n      opacity: 0.8,\n      marginBottom: theme.spacing(1),\n      color: theme.page.fontColor,\n    },\n    breadcrumb: {\n      color: theme.page.fontColor,\n    },\n    breadcrumbType: {\n      fontSize: 'inherit',\n      opacity: 0.7,\n      marginRight: -theme.spacing(0.3),\n      marginBottom: theme.spacing(0.3),\n    },\n    breadcrumbTitle: {\n      fontSize: 'inherit',\n      marginLeft: -theme.spacing(0.3),\n      marginBottom: theme.spacing(0.3),\n    },\n  }),\n  { name: 'BackstageHeader' },\n);\n\ntype HeaderStyles = ReturnType<typeof useStyles>;\n\ntype Props = {\n  component?: ReactNode;\n  pageTitleOverride?: string;\n  style?: CSSProperties;\n  subtitle?: ReactNode;\n  title: ReactNode;\n  tooltip?: string;\n  type?: string;\n  typeLink?: string;\n};\n\ntype TypeFragmentProps = {\n  classes: HeaderStyles;\n  pageTitle: string | ReactNode;\n  type?: Props['type'];\n  typeLink?: Props['typeLink'];\n};\n\ntype TitleFragmentProps = {\n  classes: HeaderStyles;\n  pageTitle: string | ReactNode;\n  tooltip?: Props['tooltip'];\n};\n\ntype SubtitleFragmentProps = {\n  classes: HeaderStyles;\n  subtitle?: Props['subtitle'];\n};\n\nconst TypeFragment = ({\n  type,\n  typeLink,\n  classes,\n  pageTitle,\n}: TypeFragmentProps) => {\n  if (!type) {\n    return null;\n  }\n\n  if (!typeLink) {\n    return <Typography className={classes.type}>{type}</Typography>;\n  }\n\n  return (\n    <Breadcrumbs className={classes.breadcrumb}>\n      <Link to={typeLink}>{type}</Link>\n      <Typography>{pageTitle}</Typography>\n    </Breadcrumbs>\n  );\n};\n\nconst TitleFragment = ({ pageTitle, classes, tooltip }: TitleFragmentProps) => {\n  const { contentRef } = useContent();\n\n  const FinalTitle = (\n    <Typography\n      ref={contentRef}\n      tabIndex={-1}\n      className={classes.title}\n      variant=\"h1\"\n    >\n      {pageTitle}\n    </Typography>\n  );\n\n  if (!tooltip) {\n    return FinalTitle;\n  }\n\n  return (\n    <Tooltip title={tooltip} placement=\"top-start\">\n      {FinalTitle}\n    </Tooltip>\n  );\n};\n\nconst SubtitleFragment = ({ classes, subtitle }: SubtitleFragmentProps) => {\n  if (!subtitle) {\n    return null;\n  }\n\n  if (typeof subtitle !== 'string') {\n    return <>{subtitle}</>;\n  }\n\n  return (\n    <Typography\n      className={classes.subtitle}\n      variant=\"subtitle2\"\n      component=\"span\"\n    >\n      {subtitle}\n    </Typography>\n  );\n};\n/**\n * Backstage main header with abstract color background in multiple variants\n *\n * @public\n *\n */\nexport function Header(props: PropsWithChildren<Props>) {\n  const {\n    children,\n    pageTitleOverride,\n    style,\n    subtitle,\n    title,\n    tooltip,\n    type,\n    typeLink,\n  } = props;\n  const classes = useStyles();\n  const configApi = useApi(configApiRef);\n  const appTitle = configApi.getOptionalString('app.title') || 'Backstage';\n  const documentTitle = pageTitleOverride || title;\n  const pageTitle = title || pageTitleOverride;\n  const titleTemplate = `${documentTitle} | %s | ${appTitle}`;\n  const defaultTitle = `${documentTitle} | ${appTitle}`;\n\n  return (\n    <>\n      <Helmet titleTemplate={titleTemplate} defaultTitle={defaultTitle} />\n      <header style={style} className={classes.header}>\n        <Box className={classes.leftItemsBox}>\n          <TypeFragment\n            classes={classes}\n            type={type}\n            typeLink={typeLink}\n            pageTitle={pageTitle}\n          />\n          <TitleFragment\n            classes={classes}\n            pageTitle={pageTitle}\n            tooltip={tooltip}\n          />\n          <SubtitleFragment classes={classes} subtitle={subtitle} />\n        </Box>\n        <Grid container className={classes.rightItemsBox} spacing={4}>\n          {children}\n        </Grid>\n      </header>\n    </>\n  );\n}\n"],"names":["React"],"mappings":"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"}