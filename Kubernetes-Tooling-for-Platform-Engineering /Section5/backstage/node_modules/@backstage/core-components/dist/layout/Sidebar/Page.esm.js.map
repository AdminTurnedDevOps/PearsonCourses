{"version":3,"file":"Page.esm.js","sources":["../../../src/layout/Sidebar/Page.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Box from '@material-ui/core/Box';\nimport { makeStyles, Theme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport React, {\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\n\nimport { SidebarConfig, SidebarConfigContext } from './config';\nimport { LocalStorage } from './localStorage';\nimport { SidebarPinStateProvider } from './SidebarPinStateContext';\n\nexport type SidebarPageClassKey = 'root';\n\ntype StyleProps = { sidebarConfig: SidebarConfig; isPinned: boolean };\n\nconst useStyles = makeStyles<Theme, StyleProps>(\n  theme => ({\n    root: {\n      width: '100%',\n      transition: 'padding-left 0.1s ease-out',\n      isolation: 'isolate',\n      [theme.breakpoints.up('sm')]: {\n        paddingLeft: (props: StyleProps) =>\n          props.isPinned\n            ? props.sidebarConfig.drawerWidthOpen\n            : props.sidebarConfig.drawerWidthClosed,\n      },\n      [theme.breakpoints.down('xs')]: {\n        paddingBottom: (props: StyleProps) =>\n          props.sidebarConfig.mobileSidebarHeight,\n      },\n      '@media print': {\n        padding: '0px !important',\n      },\n    },\n    content: {\n      zIndex: 0,\n      isolation: 'isolate',\n      '&:focus': {\n        outline: 0,\n      },\n    },\n  }),\n  { name: 'BackstageSidebarPage' },\n);\n\n/**\n * Props for SidebarPage\n *\n * @public\n */\nexport type SidebarPageProps = {\n  children?: React.ReactNode;\n};\n\ntype PageContextType = {\n  content: {\n    contentRef?: React.MutableRefObject<HTMLElement | null>;\n  };\n};\n\nconst PageContext = createContext<PageContextType>({\n  content: {\n    contentRef: undefined,\n  },\n});\nexport function SidebarPage(props: SidebarPageProps) {\n  const [isPinned, setIsPinned] = useState(() =>\n    LocalStorage.getSidebarPinState(),\n  );\n  const { sidebarConfig } = useContext(SidebarConfigContext);\n\n  const contentRef = useRef(null);\n\n  const pageContext = useMemo(\n    () => ({\n      content: {\n        contentRef,\n      },\n    }),\n    [contentRef],\n  );\n\n  useEffect(() => {\n    LocalStorage.setSidebarPinState(isPinned);\n  }, [isPinned]);\n\n  const isMobile = useMediaQuery<Theme>(theme => theme.breakpoints.down('xs'), {\n    noSsr: true,\n  });\n\n  const toggleSidebarPinState = () => setIsPinned(!isPinned);\n\n  const classes = useStyles({ isPinned, sidebarConfig });\n\n  return (\n    <SidebarPinStateProvider\n      value={{\n        isPinned,\n        toggleSidebarPinState,\n        isMobile,\n      }}\n    >\n      <PageContext.Provider value={pageContext}>\n        <Box className={classes.root}>{props.children}</Box>\n      </PageContext.Provider>\n    </SidebarPinStateProvider>\n  );\n}\n\n/**\n * This hook provides a react ref to the main content.\n * Allows to set an element as the main content and focus on that component.\n *\n * *Note: If `contentRef` is not set `focusContent` is noop. `Content` component sets this ref automatically*\n *\n * @public\n * @example\n * Focus current content\n * ```tsx\n *  const { focusContent} = useContent();\n * ...\n *  <Button onClick={focusContent}>\n *     focus main content\n *  </Button>\n * ```\n * @example\n * Set the reference to an Html element\n * ```\n *  const { contentRef } = useContent();\n * ...\n *  <article ref={contentRef} tabIndex={-1}>Main Content</article>\n * ```\n */\nexport function useContent() {\n  const { content } = useContext(PageContext);\n\n  const focusContent = useCallback(() => {\n    content?.contentRef?.current?.focus();\n  }, [content]);\n\n  return { focusContent, contentRef: content?.contentRef };\n}\n"],"names":["React"],"mappings":";;;;;;;;AAqCA,MAAM,SAAY,GAAA,UAAA;AAAA,EAChB,CAAU,KAAA,MAAA;AAAA,IACR,IAAM,EAAA;AAAA,MACJ,KAAO,EAAA,MAAA;AAAA,MACP,UAAY,EAAA,4BAAA;AAAA,MACZ,SAAW,EAAA,SAAA;AAAA,MACX,CAAC,KAAM,CAAA,WAAA,CAAY,EAAG,CAAA,IAAI,CAAC,GAAG;AAAA,QAC5B,WAAA,EAAa,CAAC,KACZ,KAAA,KAAA,CAAM,WACF,KAAM,CAAA,aAAA,CAAc,eACpB,GAAA,KAAA,CAAM,aAAc,CAAA;AAAA,OAC5B;AAAA,MACA,CAAC,KAAM,CAAA,WAAA,CAAY,IAAK,CAAA,IAAI,CAAC,GAAG;AAAA,QAC9B,aAAe,EAAA,CAAC,KACd,KAAA,KAAA,CAAM,aAAc,CAAA;AAAA,OACxB;AAAA,MACA,cAAgB,EAAA;AAAA,QACd,OAAS,EAAA;AAAA;AACX,KACF;AAAA,IACA,OAAS,EAAA;AAAA,MACP,MAAQ,EAAA,CAAA;AAAA,MACR,SAAW,EAAA,SAAA;AAAA,MACX,SAAW,EAAA;AAAA,QACT,OAAS,EAAA;AAAA;AACX;AACF,GACF,CAAA;AAAA,EACA,EAAE,MAAM,sBAAuB;AACjC,CAAA;AAiBA,MAAM,cAAc,aAA+B,CAAA;AAAA,EACjD,OAAS,EAAA;AAAA,IACP,UAAY,EAAA,KAAA;AAAA;AAEhB,CAAC,CAAA;AACM,SAAS,YAAY,KAAyB,EAAA;AACnD,EAAM,MAAA,CAAC,QAAU,EAAA,WAAW,CAAI,GAAA,QAAA;AAAA,IAAS,MACvC,aAAa,kBAAmB;AAAA,GAClC;AACA,EAAA,MAAM,EAAE,aAAA,EAAkB,GAAA,UAAA,CAAW,oBAAoB,CAAA;AAEzD,EAAM,MAAA,UAAA,GAAa,OAAO,IAAI,CAAA;AAE9B,EAAA,MAAM,WAAc,GAAA,OAAA;AAAA,IAClB,OAAO;AAAA,MACL,OAAS,EAAA;AAAA,QACP;AAAA;AACF,KACF,CAAA;AAAA,IACA,CAAC,UAAU;AAAA,GACb;AAEA,EAAA,SAAA,CAAU,MAAM;AACd,IAAA,YAAA,CAAa,mBAAmB,QAAQ,CAAA;AAAA,GAC1C,EAAG,CAAC,QAAQ,CAAC,CAAA;AAEb,EAAA,MAAM,WAAW,aAAqB,CAAA,CAAA,KAAA,KAAS,MAAM,WAAY,CAAA,IAAA,CAAK,IAAI,CAAG,EAAA;AAAA,IAC3E,KAAO,EAAA;AAAA,GACR,CAAA;AAED,EAAA,MAAM,qBAAwB,GAAA,MAAM,WAAY,CAAA,CAAC,QAAQ,CAAA;AAEzD,EAAA,MAAM,OAAU,GAAA,SAAA,CAAU,EAAE,QAAA,EAAU,eAAe,CAAA;AAErD,EACE,uBAAAA,cAAA,CAAA,aAAA;AAAA,IAAC,uBAAA;AAAA,IAAA;AAAA,MACC,KAAO,EAAA;AAAA,QACL,QAAA;AAAA,QACA,qBAAA;AAAA,QACA;AAAA;AACF,KAAA;AAAA,oBAECA,cAAA,CAAA,aAAA,CAAA,WAAA,CAAY,QAAZ,EAAA,EAAqB,KAAO,EAAA,WAAA,EAAA,kBAC1BA,cAAA,CAAA,aAAA,CAAA,GAAA,EAAA,EAAI,SAAW,EAAA,OAAA,CAAQ,IAAO,EAAA,EAAA,KAAA,CAAM,QAAS,CAChD;AAAA,GACF;AAEJ;AA0BO,SAAS,UAAa,GAAA;AAC3B,EAAA,MAAM,EAAE,OAAA,EAAY,GAAA,UAAA,CAAW,WAAW,CAAA;AAE1C,EAAM,MAAA,YAAA,GAAe,YAAY,MAAM;AACrC,IAAS,OAAA,EAAA,UAAA,EAAY,SAAS,KAAM,EAAA;AAAA,GACtC,EAAG,CAAC,OAAO,CAAC,CAAA;AAEZ,EAAA,OAAO,EAAE,YAAA,EAAc,UAAY,EAAA,OAAA,EAAS,UAAW,EAAA;AACzD;;;;"}