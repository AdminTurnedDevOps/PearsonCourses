{"version":3,"file":"addLinkClickListener.esm.js","sources":["../../../src/reader/transformers/addLinkClickListener.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport type { Transformer } from './transformer';\n\ntype AddLinkClickListenerOptions = {\n  baseUrl: string;\n  onClick: (e: MouseEvent, newUrl: string) => void;\n};\n\nexport const addLinkClickListener = ({\n  baseUrl,\n  onClick,\n}: AddLinkClickListenerOptions): Transformer => {\n  return dom => {\n    Array.from(dom.getElementsByTagName('a')).forEach(elem => {\n      elem.addEventListener('click', (e: MouseEvent) => {\n        const target = elem as HTMLAnchorElement;\n        const href = target.getAttribute('href');\n\n        if (!href) return;\n        if (href.startsWith(baseUrl) && !elem.hasAttribute('download')) {\n          e.preventDefault();\n          onClick(e, href);\n        }\n      });\n    });\n\n    return dom;\n  };\n};\n"],"names":[],"mappings":"AAuBO,MAAM,uBAAuB,CAAC;AAAA,EACnC,OAAA;AAAA,EACA;AACF,CAAgD,KAAA;AAC9C,EAAA,OAAO,CAAO,GAAA,KAAA;AACZ,IAAA,KAAA,CAAM,KAAK,GAAI,CAAA,oBAAA,CAAqB,GAAG,CAAC,CAAA,CAAE,QAAQ,CAAQ,IAAA,KAAA;AACxD,MAAK,IAAA,CAAA,gBAAA,CAAiB,OAAS,EAAA,CAAC,CAAkB,KAAA;AAChD,QAAA,MAAM,MAAS,GAAA,IAAA;AACf,QAAM,MAAA,IAAA,GAAO,MAAO,CAAA,YAAA,CAAa,MAAM,CAAA;AAEvC,QAAA,IAAI,CAAC,IAAM,EAAA;AACX,QAAI,IAAA,IAAA,CAAK,WAAW,OAAO,CAAA,IAAK,CAAC,IAAK,CAAA,YAAA,CAAa,UAAU,CAAG,EAAA;AAC9D,UAAA,CAAA,CAAE,cAAe,EAAA;AACjB,UAAA,OAAA,CAAQ,GAAG,IAAI,CAAA;AAAA;AACjB,OACD,CAAA;AAAA,KACF,CAAA;AAED,IAAO,OAAA,GAAA;AAAA,GACT;AACF;;;;"}