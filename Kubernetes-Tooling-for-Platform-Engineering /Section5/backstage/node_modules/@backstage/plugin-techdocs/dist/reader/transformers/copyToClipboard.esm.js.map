{"version":3,"file":"copyToClipboard.esm.js","sources":["../../../src/reader/transformers/copyToClipboard.tsx"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useState, useCallback } from 'react';\nimport { renderReactElement } from './renderReactElement';\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport SvgIcon from '@material-ui/core/SvgIcon';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { withStyles, Theme } from '@material-ui/core/styles';\nimport IconButton from '@material-ui/core/IconButton';\nimport type { Transformer } from './transformer';\nimport useCopyToClipboard from 'react-use/esm/useCopyToClipboard';\n\nconst CopyToClipboardTooltip = withStyles(theme => ({\n  tooltip: {\n    fontSize: 'inherit',\n    color: theme.palette.text.primary,\n    margin: 0,\n    padding: theme.spacing(0.5),\n    backgroundColor: 'transparent',\n    boxShadow: 'none',\n  },\n}))(Tooltip);\n\nconst CopyToClipboardIcon = () => (\n  <SvgIcon>\n    <path d=\"M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z\" />\n  </SvgIcon>\n);\n\ntype CopyToClipboardButtonProps = {\n  text: string;\n};\n\nconst CopyToClipboardButton = ({ text }: CopyToClipboardButtonProps) => {\n  const [open, setOpen] = useState(false);\n  const [, copyToClipboard] = useCopyToClipboard();\n\n  const handleClick = useCallback(() => {\n    copyToClipboard(text);\n    setOpen(true);\n  }, [text, copyToClipboard]);\n\n  const handleClose = useCallback(() => {\n    setOpen(false);\n  }, [setOpen]);\n\n  return (\n    <CopyToClipboardTooltip\n      title=\"Copied to clipboard\"\n      placement=\"left\"\n      open={open}\n      onClose={handleClose}\n      leaveDelay={1000}\n    >\n      <IconButton\n        style={{ color: 'inherit', position: 'absolute' }}\n        className=\"md-clipboard md-icon\"\n        onClick={handleClick}\n      >\n        <CopyToClipboardIcon />\n      </IconButton>\n    </CopyToClipboardTooltip>\n  );\n};\n\n/**\n * Recreates copy-to-clipboard functionality attached to <code> snippets that\n * is native to mkdocs-material theme.\n */\nexport const copyToClipboard = (theme: Theme): Transformer => {\n  return dom => {\n    const codes = dom.querySelectorAll('pre > code');\n    for (const code of codes) {\n      const text = code.textContent || '';\n      const container = document.createElement('div');\n      code?.parentElement?.prepend(container);\n      renderReactElement(\n        <ThemeProvider theme={theme}>\n          <CopyToClipboardButton text={text} />\n        </ThemeProvider>,\n        container,\n      );\n    }\n    return dom;\n  };\n};\n"],"names":["copyToClipboard"],"mappings":";;;;;;;;AA0BA,MAAM,sBAAA,GAAyB,WAAW,CAAU,KAAA,MAAA;AAAA,EAClD,OAAS,EAAA;AAAA,IACP,QAAU,EAAA,SAAA;AAAA,IACV,KAAA,EAAO,KAAM,CAAA,OAAA,CAAQ,IAAK,CAAA,OAAA;AAAA,IAC1B,MAAQ,EAAA,CAAA;AAAA,IACR,OAAA,EAAS,KAAM,CAAA,OAAA,CAAQ,GAAG,CAAA;AAAA,IAC1B,eAAiB,EAAA,aAAA;AAAA,IACjB,SAAW,EAAA;AAAA;AAEf,CAAA,CAAE,EAAE,OAAO,CAAA;AAEX,MAAM,mBAAA,GAAsB,sBACzB,KAAA,CAAA,aAAA,CAAA,OAAA,EAAA,IAAA,sCACE,MAAK,EAAA,EAAA,CAAA,EAAE,mIAAkI,CAC5I,CAAA;AAOF,MAAM,qBAAwB,GAAA,CAAC,EAAE,IAAA,EAAuC,KAAA;AACtE,EAAA,MAAM,CAAC,IAAA,EAAM,OAAO,CAAA,GAAI,SAAS,KAAK,CAAA;AACtC,EAAA,MAAM,GAAGA,gBAAe,CAAA,GAAI,kBAAmB,EAAA;AAE/C,EAAM,MAAA,WAAA,GAAc,YAAY,MAAM;AACpC,IAAAA,iBAAgB,IAAI,CAAA;AACpB,IAAA,OAAA,CAAQ,IAAI,CAAA;AAAA,GACX,EAAA,CAAC,IAAMA,EAAAA,gBAAe,CAAC,CAAA;AAE1B,EAAM,MAAA,WAAA,GAAc,YAAY,MAAM;AACpC,IAAA,OAAA,CAAQ,KAAK,CAAA;AAAA,GACf,EAAG,CAAC,OAAO,CAAC,CAAA;AAEZ,EACE,uBAAA,KAAA,CAAA,aAAA;AAAA,IAAC,sBAAA;AAAA,IAAA;AAAA,MACC,KAAM,EAAA,qBAAA;AAAA,MACN,SAAU,EAAA,MAAA;AAAA,MACV,IAAA;AAAA,MACA,OAAS,EAAA,WAAA;AAAA,MACT,UAAY,EAAA;AAAA,KAAA;AAAA,oBAEZ,KAAA,CAAA,aAAA;AAAA,MAAC,UAAA;AAAA,MAAA;AAAA,QACC,KAAO,EAAA,EAAE,KAAO,EAAA,SAAA,EAAW,UAAU,UAAW,EAAA;AAAA,QAChD,SAAU,EAAA,sBAAA;AAAA,QACV,OAAS,EAAA;AAAA,OAAA;AAAA,0CAER,mBAAoB,EAAA,IAAA;AAAA;AACvB,GACF;AAEJ,CAAA;AAMa,MAAA,eAAA,GAAkB,CAAC,KAA8B,KAAA;AAC5D,EAAA,OAAO,CAAO,GAAA,KAAA;AACZ,IAAM,MAAA,KAAA,GAAQ,GAAI,CAAA,gBAAA,CAAiB,YAAY,CAAA;AAC/C,IAAA,KAAA,MAAW,QAAQ,KAAO,EAAA;AACxB,MAAM,MAAA,IAAA,GAAO,KAAK,WAAe,IAAA,EAAA;AACjC,MAAM,MAAA,SAAA,GAAY,QAAS,CAAA,aAAA,CAAc,KAAK,CAAA;AAC9C,MAAM,IAAA,EAAA,aAAA,EAAe,QAAQ,SAAS,CAAA;AACtC,MAAA,kBAAA;AAAA,4CACG,aAAc,EAAA,EAAA,KAAA,EAAA,kBACZ,KAAA,CAAA,aAAA,CAAA,qBAAA,EAAA,EAAsB,MAAY,CACrC,CAAA;AAAA,QACA;AAAA,OACF;AAAA;AAEF,IAAO,OAAA,GAAA;AAAA,GACT;AACF;;;;"}