{"version":3,"file":"iframes.esm.js","sources":["../../../../../src/reader/transformers/html/hooks/iframes.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Checks whether a node is iframe or not.\n * @param node - can be any element.\n * @returns true when node is iframe.\n */\nconst isIframe = (node: Element) => node.nodeName === 'IFRAME';\n\n/**\n * Checks whether a iframe is safe or not.\n * @param node - is an iframe element.\n * @param hosts - list of allowed hosts.\n * @returns true when iframe is included in hosts.\n */\nconst isSafe = (node: Element, hosts: string[]) => {\n  const src = node.getAttribute('src') || '';\n  try {\n    const { host } = new URL(src);\n    return hosts.includes(host);\n  } catch {\n    return false;\n  }\n};\n\n/**\n * Returns a function that removes unsafe iframe nodes.\n * @param node - can be any element.\n * @param hosts - list of allowed hosts.\n */\nexport const removeUnsafeIframes = (hosts: string[]) => (node: Element) => {\n  if (isIframe(node) && !isSafe(node, hosts)) {\n    node.remove();\n  }\n  return node;\n};\n"],"names":[],"mappings":"AAqBA,MAAM,QAAW,GAAA,CAAC,IAAkB,KAAA,IAAA,CAAK,QAAa,KAAA,QAAA;AAQtD,MAAM,MAAA,GAAS,CAAC,IAAA,EAAe,KAAoB,KAAA;AACjD,EAAA,MAAM,GAAM,GAAA,IAAA,CAAK,YAAa,CAAA,KAAK,CAAK,IAAA,EAAA;AACxC,EAAI,IAAA;AACF,IAAA,MAAM,EAAE,IAAA,EAAS,GAAA,IAAI,IAAI,GAAG,CAAA;AAC5B,IAAO,OAAA,KAAA,CAAM,SAAS,IAAI,CAAA;AAAA,GACpB,CAAA,MAAA;AACN,IAAO,OAAA,KAAA;AAAA;AAEX,CAAA;AAOO,MAAM,mBAAsB,GAAA,CAAC,KAAoB,KAAA,CAAC,IAAkB,KAAA;AACzE,EAAA,IAAI,SAAS,IAAI,CAAA,IAAK,CAAC,MAAO,CAAA,IAAA,EAAM,KAAK,CAAG,EAAA;AAC1C,IAAA,IAAA,CAAK,MAAO,EAAA;AAAA;AAEd,EAAO,OAAA,IAAA;AACT;;;;"}