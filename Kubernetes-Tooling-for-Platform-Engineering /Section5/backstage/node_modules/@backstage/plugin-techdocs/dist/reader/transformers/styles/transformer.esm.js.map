{"version":3,"file":"transformer.esm.js","sources":["../../../../src/reader/transformers/styles/transformer.ts"],"sourcesContent":["/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback, useMemo } from 'react';\nimport { useTheme } from '@material-ui/core/styles';\nimport { useSidebarPinState } from '@backstage/core-components';\nimport { Transformer } from '../transformer';\nimport { rules } from './rules';\n\n/**\n * Sidebar pinned state to be used in computing style injections.\n */\nconst useSidebar = () => useSidebarPinState();\n\n/**\n * Process all rules and concatenate their definitions into a single style.\n * @returns a string containing all processed style definitions.\n */\nconst useRuleStyles = () => {\n  const sidebar = useSidebar();\n  const theme = useTheme();\n\n  return useMemo(() => {\n    const options = { theme, sidebar };\n    return rules.reduce<string>((styles, rule) => styles + rule(options), '');\n  }, [theme, sidebar]);\n};\n\n/**\n * Returns a transformer that inserts all style rules into the given element's head tag.\n */\nexport const useStylesTransformer = (): Transformer => {\n  const styles = useRuleStyles();\n\n  return useCallback(\n    (dom: Element) => {\n      dom\n        .getElementsByTagName('head')[0]\n        .insertAdjacentHTML('beforeend', `<style>${styles}</style>`);\n      return dom;\n    },\n    [styles],\n  );\n};\n"],"names":[],"mappings":";;;;;AAyBA,MAAM,UAAA,GAAa,MAAM,kBAAmB,EAAA;AAM5C,MAAM,gBAAgB,MAAM;AAC1B,EAAA,MAAM,UAAU,UAAW,EAAA;AAC3B,EAAA,MAAM,QAAQ,QAAS,EAAA;AAEvB,EAAA,OAAO,QAAQ,MAAM;AACnB,IAAM,MAAA,OAAA,GAAU,EAAE,KAAA,EAAO,OAAQ,EAAA;AACjC,IAAO,OAAA,KAAA,CAAM,OAAe,CAAC,MAAA,EAAQ,SAAS,MAAS,GAAA,IAAA,CAAK,OAAO,CAAA,EAAG,EAAE,CAAA;AAAA,GACvE,EAAA,CAAC,KAAO,EAAA,OAAO,CAAC,CAAA;AACrB,CAAA;AAKO,MAAM,uBAAuB,MAAmB;AACrD,EAAA,MAAM,SAAS,aAAc,EAAA;AAE7B,EAAO,OAAA,WAAA;AAAA,IACL,CAAC,GAAiB,KAAA;AAChB,MACG,GAAA,CAAA,oBAAA,CAAqB,MAAM,CAAE,CAAA,CAAC,EAC9B,kBAAmB,CAAA,WAAA,EAAa,CAAU,OAAA,EAAA,MAAM,CAAU,QAAA,CAAA,CAAA;AAC7D,MAAO,OAAA,GAAA;AAAA,KACT;AAAA,IACA,CAAC,MAAM;AAAA,GACT;AACF;;;;"}