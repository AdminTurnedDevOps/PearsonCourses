{"version":3,"file":"EntityListDocsTable.esm.js","sources":["../../../../src/home/components/Tables/EntityListDocsTable.tsx"],"sourcesContent":["/*\n * Copyright 2021 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport useCopyToClipboard from 'react-use/esm/useCopyToClipboard';\nimport { capitalize } from 'lodash';\nimport {\n  CodeSnippet,\n  TableColumn,\n  TableOptions,\n  TableProps,\n  WarningPanel,\n} from '@backstage/core-components';\nimport { configApiRef, useApi, useRouteRef } from '@backstage/core-plugin-api';\nimport {\n  useEntityList,\n  useStarredEntities,\n} from '@backstage/plugin-catalog-react';\nimport { DocsTable } from './DocsTable';\nimport { OffsetPaginatedDocsTable } from './OffsetPaginatedDocsTable';\nimport { CursorPaginatedDocsTable } from './CursorPaginatedDocsTable';\nimport { actionFactories } from './actions';\nimport { columnFactories, defaultColumns } from './columns';\nimport { DocsTableRow } from './types';\nimport { rootDocsRouteRef } from '../../../routes';\nimport { entitiesToDocsMapper } from './helpers';\n\n/**\n * Props for {@link EntityListDocsTable}.\n *\n * @public\n */\nexport type EntityListDocsTableProps = {\n  columns?: TableColumn<DocsTableRow>[];\n  actions?: TableProps<DocsTableRow>['actions'];\n  options?: TableOptions<DocsTableRow>;\n};\n\n/**\n * Component which renders a table with entities from catalog.\n *\n * @public\n */\nexport const EntityListDocsTable = (props: EntityListDocsTableProps) => {\n  const { columns, actions, options } = props;\n  const { loading, error, entities, filters, paginationMode, pageInfo } =\n    useEntityList();\n  const { isStarredEntity, toggleStarredEntity } = useStarredEntities();\n  const [, copyToClipboard] = useCopyToClipboard();\n  const getRouteToReaderPageFor = useRouteRef(rootDocsRouteRef);\n  const config = useApi(configApiRef);\n\n  const title = capitalize(filters.user?.value ?? 'all');\n\n  const defaultActions = [\n    actionFactories.createCopyDocsUrlAction(copyToClipboard),\n    actionFactories.createStarEntityAction(\n      isStarredEntity,\n      toggleStarredEntity,\n    ),\n  ];\n\n  const documents = entitiesToDocsMapper(\n    entities,\n    getRouteToReaderPageFor,\n    config,\n  );\n\n  if (paginationMode === 'cursor') {\n    return (\n      <CursorPaginatedDocsTable\n        columns={columns || defaultColumns}\n        isLoading={loading}\n        title={title}\n        actions={actions || defaultActions}\n        options={options}\n        data={documents}\n        next={pageInfo?.next}\n        prev={pageInfo?.prev}\n      />\n    );\n  } else if (paginationMode === 'offset') {\n    return (\n      <OffsetPaginatedDocsTable\n        columns={columns || defaultColumns}\n        isLoading={loading}\n        title={title}\n        actions={actions || defaultActions}\n        options={options}\n        data={documents}\n      />\n    );\n  }\n\n  if (error) {\n    return (\n      <WarningPanel\n        severity=\"error\"\n        title=\"Could not load available documentation.\"\n      >\n        <CodeSnippet language=\"text\" text={error.toString()} />\n      </WarningPanel>\n    );\n  }\n\n  return (\n    <DocsTable\n      title={title}\n      entities={entities}\n      loading={loading}\n      actions={actions || defaultActions}\n      columns={columns}\n      options={options}\n    />\n  );\n};\n\nEntityListDocsTable.columns = columnFactories;\nEntityListDocsTable.actions = actionFactories;\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAwDa,MAAA,mBAAA,GAAsB,CAAC,KAAoC,KAAA;AACtE,EAAA,MAAM,EAAE,OAAA,EAAS,OAAS,EAAA,OAAA,EAAY,GAAA,KAAA;AACtC,EAAM,MAAA,EAAE,SAAS,KAAO,EAAA,QAAA,EAAU,SAAS,cAAgB,EAAA,QAAA,KACzD,aAAc,EAAA;AAChB,EAAA,MAAM,EAAE,eAAA,EAAiB,mBAAoB,EAAA,GAAI,kBAAmB,EAAA;AACpE,EAAA,MAAM,GAAG,eAAe,CAAA,GAAI,kBAAmB,EAAA;AAC/C,EAAM,MAAA,uBAAA,GAA0B,YAAY,gBAAgB,CAAA;AAC5D,EAAM,MAAA,MAAA,GAAS,OAAO,YAAY,CAAA;AAElC,EAAA,MAAM,KAAQ,GAAA,UAAA,CAAW,OAAQ,CAAA,IAAA,EAAM,SAAS,KAAK,CAAA;AAErD,EAAA,MAAM,cAAiB,GAAA;AAAA,IACrB,eAAA,CAAgB,wBAAwB,eAAe,CAAA;AAAA,IACvD,eAAgB,CAAA,sBAAA;AAAA,MACd,eAAA;AAAA,MACA;AAAA;AACF,GACF;AAEA,EAAA,MAAM,SAAY,GAAA,oBAAA;AAAA,IAChB,QAAA;AAAA,IACA,uBAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,IAAI,mBAAmB,QAAU,EAAA;AAC/B,IACE,uBAAA,KAAA,CAAA,aAAA;AAAA,MAAC,wBAAA;AAAA,MAAA;AAAA,QACC,SAAS,OAAW,IAAA,cAAA;AAAA,QACpB,SAAW,EAAA,OAAA;AAAA,QACX,KAAA;AAAA,QACA,SAAS,OAAW,IAAA,cAAA;AAAA,QACpB,OAAA;AAAA,QACA,IAAM,EAAA,SAAA;AAAA,QACN,MAAM,QAAU,EAAA,IAAA;AAAA,QAChB,MAAM,QAAU,EAAA;AAAA;AAAA,KAClB;AAAA,GAEJ,MAAA,IAAW,mBAAmB,QAAU,EAAA;AACtC,IACE,uBAAA,KAAA,CAAA,aAAA;AAAA,MAAC,wBAAA;AAAA,MAAA;AAAA,QACC,SAAS,OAAW,IAAA,cAAA;AAAA,QACpB,SAAW,EAAA,OAAA;AAAA,QACX,KAAA;AAAA,QACA,SAAS,OAAW,IAAA,cAAA;AAAA,QACpB,OAAA;AAAA,QACA,IAAM,EAAA;AAAA;AAAA,KACR;AAAA;AAIJ,EAAA,IAAI,KAAO,EAAA;AACT,IACE,uBAAA,KAAA,CAAA,aAAA;AAAA,MAAC,YAAA;AAAA,MAAA;AAAA,QACC,QAAS,EAAA,OAAA;AAAA,QACT,KAAM,EAAA;AAAA,OAAA;AAAA,0CAEL,WAAY,EAAA,EAAA,QAAA,EAAS,QAAO,IAAM,EAAA,KAAA,CAAM,UAAY,EAAA;AAAA,KACvD;AAAA;AAIJ,EACE,uBAAA,KAAA,CAAA,aAAA;AAAA,IAAC,SAAA;AAAA,IAAA;AAAA,MACC,KAAA;AAAA,MACA,QAAA;AAAA,MACA,OAAA;AAAA,MACA,SAAS,OAAW,IAAA,cAAA;AAAA,MACpB,OAAA;AAAA,MACA;AAAA;AAAA,GACF;AAEJ;AAEA,mBAAA,CAAoB,OAAU,GAAA,eAAA;AAC9B,mBAAA,CAAoB,OAAU,GAAA,eAAA;;;;"}