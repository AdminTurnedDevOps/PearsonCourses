{"version":3,"file":"useTemplateDirectory.esm.js","sources":["../../../../src/alpha/components/TemplateEditorPage/useTemplateDirectory.ts"],"sourcesContent":["/*\n * Copyright 2024 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useCallback } from 'react';\nimport useAsyncRetry from 'react-use/esm/useAsyncRetry';\n\nimport {\n  WebFileSystemStore,\n  WebFileSystemAccess,\n  WebDirectoryAccess,\n  createExampleTemplate,\n} from '../../../lib/filesystem';\n\nexport function useTemplateDirectory(): {\n  directory?: WebDirectoryAccess;\n  loading: boolean;\n  error?: Error;\n  openDirectory: () => Promise<void>;\n  createDirectory: () => Promise<void>;\n  closeDirectory: () => Promise<void>;\n} {\n  const { value, loading, error, retry } = useAsyncRetry(async () => {\n    const directory = await WebFileSystemStore.getDirectory();\n    if (!directory) return undefined;\n    return WebFileSystemAccess.fromHandle(directory);\n  }, []);\n\n  const openDirectory = useCallback(() => {\n    return WebFileSystemAccess.requestDirectoryAccess()\n      .then(WebFileSystemStore.setDirectory)\n      .then(retry);\n  }, [retry]);\n\n  const createDirectory = useCallback(() => {\n    return WebFileSystemAccess.requestDirectoryAccess()\n      .then(createExampleTemplate)\n      .then(WebFileSystemStore.setDirectory)\n      .then(retry);\n  }, [retry]);\n\n  const closeDirectory = useCallback(() => {\n    return WebFileSystemStore.setDirectory(undefined).then(retry);\n  }, [retry]);\n\n  return {\n    directory: value,\n    loading,\n    error,\n    openDirectory,\n    createDirectory,\n    closeDirectory,\n  };\n}\n"],"names":[],"mappings":";;;;;;AA0BO,SAAS,oBAOd,GAAA;AACA,EAAA,MAAM,EAAE,KAAO,EAAA,OAAA,EAAS,OAAO,KAAM,EAAA,GAAI,cAAc,YAAY;AACjE,IAAM,MAAA,SAAA,GAAY,MAAM,kBAAA,CAAmB,YAAa,EAAA;AACxD,IAAI,IAAA,CAAC,WAAkB,OAAA,KAAA,CAAA;AACvB,IAAO,OAAA,mBAAA,CAAoB,WAAW,SAAS,CAAA;AAAA,GACjD,EAAG,EAAE,CAAA;AAEL,EAAM,MAAA,aAAA,GAAgB,YAAY,MAAM;AACtC,IAAO,OAAA,mBAAA,CAAoB,wBACxB,CAAA,IAAA,CAAK,mBAAmB,YAAY,CAAA,CACpC,KAAK,KAAK,CAAA;AAAA,GACf,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAM,MAAA,eAAA,GAAkB,YAAY,MAAM;AACxC,IAAO,OAAA,mBAAA,CAAoB,sBAAuB,EAAA,CAC/C,IAAK,CAAA,qBAAqB,CAC1B,CAAA,IAAA,CAAK,kBAAmB,CAAA,YAAY,CACpC,CAAA,IAAA,CAAK,KAAK,CAAA;AAAA,GACf,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAM,MAAA,cAAA,GAAiB,YAAY,MAAM;AACvC,IAAA,OAAO,kBAAmB,CAAA,YAAA,CAAa,KAAS,CAAA,CAAA,CAAE,KAAK,KAAK,CAAA;AAAA,GAC9D,EAAG,CAAC,KAAK,CAAC,CAAA;AAEV,EAAO,OAAA;AAAA,IACL,SAAW,EAAA,KAAA;AAAA,IACX,OAAA;AAAA,IACA,KAAA;AAAA,IACA,aAAA;AAAA,IACA,eAAA;AAAA,IACA;AAAA,GACF;AACF;;;;"}