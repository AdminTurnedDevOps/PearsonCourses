{"version":3,"file":"deployments.esm.js","sources":["../../src/error-detection/deployments.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { DetectedError, ErrorMapper } from './types';\nimport { Deployment } from 'kubernetes-models/apps/v1';\nimport { detectErrorsInObjects } from './common';\n\nconst deploymentErrorMappers: ErrorMapper<Deployment>[] = [\n  {\n    detectErrors: deployment => {\n      return (deployment.status?.conditions ?? [])\n        .filter(c => c.status === 'False')\n        .filter(c => c.message !== undefined)\n        .map(c => ({\n          type: 'condition-message-present',\n          message: c.message ?? '',\n          severity: 6,\n          sourceRef: {\n            name: deployment.metadata?.name ?? 'unknown hpa',\n            namespace: deployment.metadata?.namespace ?? 'unknown namespace',\n            kind: 'Deployment',\n            apiGroup: 'apps/v1',\n          },\n          occurrenceCount: 1,\n        }));\n    },\n  },\n];\n\nexport const detectErrorsInDeployments = (\n  deployments: Deployment[],\n): DetectedError[] =>\n  detectErrorsInObjects(deployments, deploymentErrorMappers);\n"],"names":[],"mappings":";;AAoBA,MAAM,sBAAoD,GAAA;AAAA,EACxD;AAAA,IACE,cAAc,CAAc,UAAA,KAAA;AAC1B,MAAA,OAAA,CAAQ,WAAW,MAAQ,EAAA,UAAA,IAAc,EACtC,EAAA,MAAA,CAAO,OAAK,CAAE,CAAA,MAAA,KAAW,OAAO,CAAA,CAChC,OAAO,CAAK,CAAA,KAAA,CAAA,CAAE,YAAY,KAAS,CAAA,CAAA,CACnC,IAAI,CAAM,CAAA,MAAA;AAAA,QACT,IAAM,EAAA,2BAAA;AAAA,QACN,OAAA,EAAS,EAAE,OAAW,IAAA,EAAA;AAAA,QACtB,QAAU,EAAA,CAAA;AAAA,QACV,SAAW,EAAA;AAAA,UACT,IAAA,EAAM,UAAW,CAAA,QAAA,EAAU,IAAQ,IAAA,aAAA;AAAA,UACnC,SAAA,EAAW,UAAW,CAAA,QAAA,EAAU,SAAa,IAAA,mBAAA;AAAA,UAC7C,IAAM,EAAA,YAAA;AAAA,UACN,QAAU,EAAA;AAAA,SACZ;AAAA,QACA,eAAiB,EAAA;AAAA,OACjB,CAAA,CAAA;AAAA;AACN;AAEJ,CAAA;AAEO,MAAM,yBAA4B,GAAA,CACvC,WAEA,KAAA,qBAAA,CAAsB,aAAa,sBAAsB;;;;"}