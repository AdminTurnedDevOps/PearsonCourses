'use strict';

var fs = require('fs-extra');
var path = require('path');
var bundle = require('../../lib/bundler/bundle.cjs.js');
var moduleFederation = require('../../lib/bundler/moduleFederation.cjs.js');
require('chalk');
require('react-dev-utils/openBrowser');
require('webpack');
require('webpack-dev-server');
require('../../lib/paths.cjs.js');
var config = require('../../modules/config/lib/config.cjs.js');
require('eslint-webpack-plugin');
require('fork-ts-checker-webpack-plugin');
require('html-webpack-plugin');
require('@module-federation/enhanced/webpack');
require('react-dev-utils/ModuleScopePlugin');
require('@pmmmwh/react-refresh-webpack-plugin');
require('../../lib/bundler/optimization.cjs.js');
require('lodash/pickBy');
require('../../lib/run.cjs.js');
require('mini-css-extract-plugin');
require('../../lib/version.cjs.js');
require('yn');
require('@manypkg/get-packages');
require('../../lib/bundler/packageDetection.cjs.js');
var parallel = require('../../lib/parallel.cjs.js');

function _interopDefaultCompat (e) { return e && typeof e === 'object' && 'default' in e ? e : { default: e }; }

var fs__default = /*#__PURE__*/_interopDefaultCompat(fs);

async function buildFrontend(options) {
  const { targetDir, writeStats, configPaths, rspack } = options;
  const packageJson = await fs__default.default.readJson(
    path.resolve(targetDir, "package.json")
  );
  await bundle.buildBundle({
    targetDir,
    entry: "src/index",
    parallelism: parallel.getEnvironmentParallelism(),
    statsJsonEnabled: writeStats,
    moduleFederation: await moduleFederation.getModuleFederationOptions(
      packageJson,
      path.resolve(targetDir),
      options.isModuleFederationRemote
    ),
    ...await config.loadCliConfig({
      args: configPaths,
      fromPackage: packageJson.name
    }),
    rspack
  });
}

exports.buildFrontend = buildFrontend;
//# sourceMappingURL=buildFrontend.cjs.js.map
