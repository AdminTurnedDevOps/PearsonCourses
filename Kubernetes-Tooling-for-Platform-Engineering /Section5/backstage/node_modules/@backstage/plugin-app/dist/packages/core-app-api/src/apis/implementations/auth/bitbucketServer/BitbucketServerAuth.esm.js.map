{"version":3,"file":"BitbucketServerAuth.esm.js","sources":["../../../../../../../../../../packages/core-app-api/src/apis/implementations/auth/bitbucketServer/BitbucketServerAuth.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  BackstageIdentityResponse,\n  bitbucketServerAuthApiRef,\n  ProfileInfo,\n} from '@backstage/core-plugin-api';\n\nimport { OAuthApiCreateOptions } from '../types';\nimport { OAuth2 } from '../oauth2';\n\nexport type BitbucketServerAuthResponse = {\n  providerInfo: {\n    accessToken: string;\n    scope: string;\n    expiresInSeconds: number;\n  };\n  profile: ProfileInfo;\n  backstageIdentity: BackstageIdentityResponse;\n};\n\nconst DEFAULT_PROVIDER = {\n  id: 'bitbucketServer',\n  title: 'Bitbucket Server',\n  icon: () => null,\n};\n\n/**\n * Implements the OAuth flow to Bitbucket Server.\n * @public\n */\nexport default class BitbucketServerAuth {\n  static create(\n    options: OAuthApiCreateOptions,\n  ): typeof bitbucketServerAuthApiRef.T {\n    const {\n      configApi,\n      discoveryApi,\n      environment = 'development',\n      provider = DEFAULT_PROVIDER,\n      oauthRequestApi,\n      defaultScopes = ['PROJECT_ADMIN'],\n    } = options;\n\n    return OAuth2.create({\n      configApi,\n      discoveryApi,\n      oauthRequestApi,\n      provider,\n      environment,\n      defaultScopes,\n    });\n  }\n}\n"],"names":[],"mappings":";;AAmCA,MAAM,gBAAmB,GAAA;AAAA,EACvB,EAAI,EAAA,iBAAA;AAAA,EACJ,KAAO,EAAA,kBAAA;AAAA,EACP,MAAM,MAAM;AACd,CAAA;AAMA,MAAqB,mBAAoB,CAAA;AAAA,EACvC,OAAO,OACL,OACoC,EAAA;AACpC,IAAM,MAAA;AAAA,MACJ,SAAA;AAAA,MACA,YAAA;AAAA,MACA,WAAc,GAAA,aAAA;AAAA,MACd,QAAW,GAAA,gBAAA;AAAA,MACX,eAAA;AAAA,MACA,aAAA,GAAgB,CAAC,eAAe;AAAA,KAC9B,GAAA,OAAA;AAEJ,IAAA,OAAO,OAAO,MAAO,CAAA;AAAA,MACnB,SAAA;AAAA,MACA,YAAA;AAAA,MACA,eAAA;AAAA,MACA,QAAA;AAAA,MACA,WAAA;AAAA,MACA;AAAA,KACD,CAAA;AAAA;AAEL;;;;"}