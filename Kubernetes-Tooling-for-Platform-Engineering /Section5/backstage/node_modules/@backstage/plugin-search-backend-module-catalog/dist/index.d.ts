/// <reference types="node" />
import * as _backstage_backend_plugin_api from '@backstage/backend-plugin-api';
import { AuthService, DiscoveryService } from '@backstage/backend-plugin-api';
import { CatalogCollatorEntityTransformer as CatalogCollatorEntityTransformer$1 } from '@backstage/plugin-search-backend-module-catalog';
import { TokenManager } from '@backstage/backend-common';
import { GetEntitiesRequest, CatalogApi } from '@backstage/catalog-client';
import { Config } from '@backstage/config';
import { Permission } from '@backstage/plugin-permission-common';
import { DocumentCollatorFactory } from '@backstage/plugin-search-common';
import { Readable } from 'stream';
import { Entity } from '@backstage/catalog-model';
import { CatalogEntityDocument } from '@backstage/plugin-catalog-common';

/**
 * Options for {@link catalogCollatorExtensionPoint}.
 *
 * @public
 */
type CatalogCollatorExtensionPoint = {
    /**
     * Allows you to customize how entities are shaped into documents.
     */
    setEntityTransformer(transformer: CatalogCollatorEntityTransformer$1): void;
};
/**
 * Extension point for customizing how catalog entities are shaped into
 * documents for the search backend.
 *
 * @public
 */
declare const catalogCollatorExtensionPoint: _backstage_backend_plugin_api.ExtensionPoint<CatalogCollatorExtensionPoint>;
/**
 * Search backend module for the Catalog index.
 *
 * @public
 */
declare const _default: _backstage_backend_plugin_api.BackendFeature;

/** @public */
type CatalogCollatorEntityTransformer = (entity: Entity) => Omit<CatalogEntityDocument, 'location' | 'authorization'>;

/**
 * @public
 * @deprecated This type is deprecated along with the {@link DefaultCatalogCollatorFactory}.
 */
type DefaultCatalogCollatorFactoryOptions = {
    auth?: AuthService;
    discovery: DiscoveryService;
    tokenManager?: TokenManager;
    /**
     * @deprecated Use the config key `search.collators.catalog.locationTemplate` instead.
     */
    locationTemplate?: string;
    /**
     * @deprecated Use the config key `search.collators.catalog.filter` instead.
     */
    filter?: GetEntitiesRequest['filter'];
    /**
     * @deprecated Use the config key `search.collators.catalog.batchSize` instead.
     */
    batchSize?: number;
    catalogClient?: CatalogApi;
    /**
     * Allows you to customize how entities are shaped into documents.
     */
    entityTransformer?: CatalogCollatorEntityTransformer;
};
/**
 * Collates entities from the Catalog into documents for the search backend.
 *
 * @public
 * @deprecated Migrate to the {@link https://backstage.io/docs/backend-system/building-backends/migrating | new backend system} and install this collator via module instead (see {@link https://github.com/backstage/backstage/blob/nbs10/search-deprecate-create-router/plugins/search-backend-module-catalog/README.md#installation | here} for more installation details).
 */
declare class DefaultCatalogCollatorFactory implements DocumentCollatorFactory {
    readonly type = "software-catalog";
    readonly visibilityPermission: Permission;
    private locationTemplate;
    private filter?;
    private batchSize;
    private readonly catalogClient;
    private entityTransformer;
    private auth;
    static fromConfig(configRoot: Config, options: DefaultCatalogCollatorFactoryOptions): DefaultCatalogCollatorFactory;
    private constructor();
    getCollator(): Promise<Readable>;
    private execute;
    private applyArgsToFormat;
}

/** @public */
declare const defaultCatalogCollatorEntityTransformer: CatalogCollatorEntityTransformer;

export { type CatalogCollatorEntityTransformer, type CatalogCollatorExtensionPoint, DefaultCatalogCollatorFactory, type DefaultCatalogCollatorFactoryOptions, catalogCollatorExtensionPoint, _default as default, defaultCatalogCollatorEntityTransformer };
