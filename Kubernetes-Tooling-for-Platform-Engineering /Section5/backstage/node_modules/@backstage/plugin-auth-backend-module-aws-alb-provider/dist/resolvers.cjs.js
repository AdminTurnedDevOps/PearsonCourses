'use strict';

var pluginAuthNode = require('@backstage/plugin-auth-node');

exports.awsAlbSignInResolvers = void 0;
((awsAlbSignInResolvers2) => {
  awsAlbSignInResolvers2.emailMatchingUserEntityProfileEmail = pluginAuthNode.createSignInResolverFactory({
    create() {
      return async (info, ctx) => {
        if (!info.result.fullProfile.emails) {
          throw new Error(
            "Login failed, user profile does not contain an email"
          );
        }
        return ctx.signInWithCatalogUser({
          filter: {
            kind: ["User"],
            "spec.profile.email": info.result.fullProfile.emails[0].value
          }
        });
      };
    }
  });
})(exports.awsAlbSignInResolvers || (exports.awsAlbSignInResolvers = {}));
//# sourceMappingURL=resolvers.cjs.js.map
