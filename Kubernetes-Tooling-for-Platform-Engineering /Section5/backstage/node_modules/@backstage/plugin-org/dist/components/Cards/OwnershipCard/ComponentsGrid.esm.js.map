{"version":3,"file":"ComponentsGrid.esm.js","sources":["../../../../src/components/Cards/OwnershipCard/ComponentsGrid.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Entity } from '@backstage/catalog-model';\nimport {\n  Link,\n  OverflowTooltip,\n  Progress,\n  ResponseErrorPanel,\n} from '@backstage/core-components';\nimport { useRouteRef } from '@backstage/core-plugin-api';\nimport Box from '@material-ui/core/Box';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { createStyles, makeStyles } from '@material-ui/core/styles';\nimport React from 'react';\nimport pluralize from 'pluralize';\nimport { catalogIndexRouteRef } from '../../../routes';\nimport { useGetEntities } from './useGetEntities';\nimport { EntityRelationAggregation } from '../types';\n\nconst useStyles = makeStyles(theme =>\n  createStyles({\n    card: {\n      border: `1px solid ${theme.palette.divider}`,\n      boxShadow: theme.shadows[2],\n      borderRadius: '4px',\n      padding: theme.spacing(2),\n      transition: `${theme.transitions.duration.standard}ms`,\n      '&:hover': {\n        boxShadow: theme.shadows[4],\n      },\n      height: '100%',\n    },\n    bold: {\n      fontWeight: theme.typography.fontWeightBold,\n    },\n    smallFont: {\n      fontSize: theme.typography.body2.fontSize,\n    },\n    entityTypeBox: {\n      background: (props: { type: string }) =>\n        theme.getPageTheme({ themeId: props.type }).backgroundImage,\n      color: (props: { type: string }) =>\n        theme.getPageTheme({ themeId: props.type }).fontColor,\n    },\n  }),\n);\n\nconst EntityCountTile = ({\n  counter,\n  type,\n  kind,\n  url,\n}: {\n  counter: number;\n  type?: string;\n  kind: string;\n  url?: string;\n}) => {\n  const classes = useStyles({ type: type ?? kind });\n\n  const rawTitle = type ?? kind;\n  const isLongText = rawTitle.length > 10;\n\n  const tile = (\n    <Box\n      className={`${classes.card} ${classes.entityTypeBox}`}\n      display=\"flex\"\n      flexDirection=\"column\"\n      alignItems=\"center\"\n    >\n      <Typography className={classes.bold} variant=\"h6\">\n        {counter}\n      </Typography>\n      <Box sx={{ width: '100%', textAlign: 'center' }}>\n        <Typography\n          className={`${classes.bold} ${isLongText && classes.smallFont}`}\n          variant=\"h6\"\n        >\n          <OverflowTooltip\n            text={pluralize(rawTitle.toLocaleUpperCase('en-US'), counter)}\n          />\n        </Typography>\n      </Box>\n      {type && <Typography variant=\"subtitle1\">{kind}</Typography>}\n    </Box>\n  );\n\n  if (url) {\n    return (\n      <Link to={url} variant=\"body2\">\n        {tile}\n      </Link>\n    );\n  }\n  return tile;\n};\n\nexport const ComponentsGrid = ({\n  className,\n  entity,\n  relationsType,\n  relationAggregation,\n  entityFilterKind,\n  entityLimit = 6,\n}: {\n  className?: string;\n  entity: Entity;\n  /** @deprecated Please use relationAggregation instead */\n  relationsType?: EntityRelationAggregation;\n  relationAggregation?: EntityRelationAggregation;\n  entityFilterKind?: string[];\n  entityLimit?: number;\n}) => {\n  const catalogLink = useRouteRef(catalogIndexRouteRef);\n  if (!relationsType && !relationAggregation) {\n    throw new Error(\n      'The relationAggregation property must be set as an EntityRelationAggregation type.',\n    );\n  }\n  const { componentsWithCounters, loading, error } = useGetEntities(\n    entity,\n    (relationAggregation ?? relationsType)!, // we can safely use the non-null assertion here because of the run-time check above\n    entityFilterKind,\n    entityLimit,\n  );\n\n  if (loading) {\n    return <Progress />;\n  } else if (error) {\n    return <ResponseErrorPanel error={error} />;\n  }\n\n  return (\n    <Grid container className={className}>\n      {componentsWithCounters?.map(c => (\n        <Grid item xs={6} md={6} lg={4} key={c.type ?? c.kind}>\n          <EntityCountTile\n            counter={c.counter}\n            kind={c.kind}\n            type={c.type}\n            url={catalogLink && `${catalogLink()}/?${c.queryParams}`}\n          />\n        </Grid>\n      ))}\n    </Grid>\n  );\n};\n"],"names":[],"mappings":"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"}