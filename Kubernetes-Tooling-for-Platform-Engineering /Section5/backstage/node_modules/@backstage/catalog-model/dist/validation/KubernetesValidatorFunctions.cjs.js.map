{"version":3,"file":"KubernetesValidatorFunctions.cjs.js","sources":["../../src/validation/KubernetesValidatorFunctions.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { CommonValidatorFunctions } from './CommonValidatorFunctions';\n\n/**\n * Contains validation functions that match the Kubernetes spec, usable to\n * build a catalog that is compatible with those rule sets.\n *\n * @public\n * @see https://kubernetes.io/docs/concepts/overview/working-with-objects/names/\n * @see https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#syntax-and-character-set\n * @see https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/#syntax-and-character-set\n */\nexport class KubernetesValidatorFunctions {\n  static isValidApiVersion(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidPrefixAndOrSuffix(\n      value,\n      '/',\n      CommonValidatorFunctions.isValidDnsSubdomain,\n      n => n.length >= 1 && n.length <= 63 && /^[a-z0-9A-Z]+$/.test(n),\n    );\n  }\n\n  static isValidKind(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^[a-zA-Z][a-z0-9A-Z]*$/.test(value)\n    );\n  }\n\n  static isValidObjectName(value: unknown): boolean {\n    return (\n      typeof value === 'string' &&\n      value.length >= 1 &&\n      value.length <= 63 &&\n      /^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$/.test(value)\n    );\n  }\n\n  static isValidNamespace(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidDnsLabel(value);\n  }\n\n  static isValidLabelKey(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidPrefixAndOrSuffix(\n      value,\n      '/',\n      CommonValidatorFunctions.isValidDnsSubdomain,\n      KubernetesValidatorFunctions.isValidObjectName,\n    );\n  }\n\n  static isValidLabelValue(value: unknown): boolean {\n    return (\n      value === '' || KubernetesValidatorFunctions.isValidObjectName(value)\n    );\n  }\n\n  static isValidAnnotationKey(value: unknown): boolean {\n    return CommonValidatorFunctions.isValidPrefixAndOrSuffix(\n      value,\n      '/',\n      CommonValidatorFunctions.isValidDnsSubdomain,\n      KubernetesValidatorFunctions.isValidObjectName,\n    );\n  }\n\n  static isValidAnnotationValue(value: unknown): boolean {\n    return typeof value === 'string';\n  }\n}\n"],"names":["CommonValidatorFunctions"],"mappings":";;;;AA2BO,MAAM,4BAA6B,CAAA;AAAA,EACxC,OAAO,kBAAkB,KAAyB,EAAA;AAChD,IAAA,OAAOA,iDAAyB,CAAA,wBAAA;AAAA,MAC9B,KAAA;AAAA,MACA,GAAA;AAAA,MACAA,iDAAyB,CAAA,mBAAA;AAAA,MACzB,CAAA,CAAA,KAAK,EAAE,MAAU,IAAA,CAAA,IAAK,EAAE,MAAU,IAAA,EAAA,IAAM,gBAAiB,CAAA,IAAA,CAAK,CAAC;AAAA,KACjE;AAAA;AACF,EAEA,OAAO,YAAY,KAAyB,EAAA;AAC1C,IACE,OAAA,OAAO,KAAU,KAAA,QAAA,IACjB,KAAM,CAAA,MAAA,IAAU,CAChB,IAAA,KAAA,CAAM,MAAU,IAAA,EAAA,IAChB,wBAAyB,CAAA,IAAA,CAAK,KAAK,CAAA;AAAA;AAEvC,EAEA,OAAO,kBAAkB,KAAyB,EAAA;AAChD,IACE,OAAA,OAAO,KAAU,KAAA,QAAA,IACjB,KAAM,CAAA,MAAA,IAAU,CAChB,IAAA,KAAA,CAAM,MAAU,IAAA,EAAA,IAChB,4CAA6C,CAAA,IAAA,CAAK,KAAK,CAAA;AAAA;AAE3D,EAEA,OAAO,iBAAiB,KAAyB,EAAA;AAC/C,IAAO,OAAAA,iDAAA,CAAyB,gBAAgB,KAAK,CAAA;AAAA;AACvD,EAEA,OAAO,gBAAgB,KAAyB,EAAA;AAC9C,IAAA,OAAOA,iDAAyB,CAAA,wBAAA;AAAA,MAC9B,KAAA;AAAA,MACA,GAAA;AAAA,MACAA,iDAAyB,CAAA,mBAAA;AAAA,MACzB,4BAA6B,CAAA;AAAA,KAC/B;AAAA;AACF,EAEA,OAAO,kBAAkB,KAAyB,EAAA;AAChD,IAAA,OACE,KAAU,KAAA,EAAA,IAAM,4BAA6B,CAAA,iBAAA,CAAkB,KAAK,CAAA;AAAA;AAExE,EAEA,OAAO,qBAAqB,KAAyB,EAAA;AACnD,IAAA,OAAOA,iDAAyB,CAAA,wBAAA;AAAA,MAC9B,KAAA;AAAA,MACA,GAAA;AAAA,MACAA,iDAAyB,CAAA,mBAAA;AAAA,MACzB,4BAA6B,CAAA;AAAA,KAC/B;AAAA;AACF,EAEA,OAAO,uBAAuB,KAAyB,EAAA;AACrD,IAAA,OAAO,OAAO,KAAU,KAAA,QAAA;AAAA;AAE5B;;;;"}