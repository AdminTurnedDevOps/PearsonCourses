{"version":3,"file":"DefaultEntityPresentationApi.esm.js","sources":["../../../src/apis/EntityPresentationApi/DefaultEntityPresentationApi.ts"],"sourcesContent":["/*\n * Copyright 2023 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  Entity,\n  parseEntityRef,\n  stringifyEntityRef,\n} from '@backstage/catalog-model';\nimport { IconComponent } from '@backstage/core-plugin-api';\nimport {\n  CatalogApi,\n  EntityPresentationApi,\n  EntityRefPresentation,\n  EntityRefPresentationSnapshot,\n} from '@backstage/plugin-catalog-react';\nimport { durationToMilliseconds, HumanDuration } from '@backstage/types';\nimport DataLoader from 'dataloader';\nimport ExpiryMap from 'expiry-map';\nimport ObservableImpl from 'zen-observable';\nimport {\n  createDefaultRenderer,\n  DEFAULT_BATCH_DELAY,\n  DEFAULT_CACHE_TTL,\n  DEFAULT_ICONS,\n} from './defaults';\n\n/**\n * A custom renderer for the {@link DefaultEntityPresentationApi}.\n *\n * @public\n */\nexport interface DefaultEntityPresentationApiRenderer {\n  /**\n   * Whether to request the entity from the catalog API asynchronously.\n   *\n   * @remarks\n   *\n   * If this is set to true, entity data will be streamed in from the catalog\n   * whenever needed, and the render function may be called more than once:\n   * first when no entity data existed (or with old cached data), and then again\n   * at a later point when data is loaded from the catalog that proved to be\n   * different from the old one.\n   *\n   * @defaultValue true\n   */\n  async?: boolean;\n\n  /**\n   * The actual render function.\n   *\n   * @remarks\n   *\n   * This function may be called multiple times.\n   *\n   * The loading flag signals that the framework MAY be trying to load more\n   * entity data from the catalog and call the render function again, if it\n   * succeeds. In some cases you may want to render a loading state in that\n   * case.\n   *\n   * The entity may or may not be given. If the caller of the presentation API\n   * did present an entity upfront, then that's what will be passed in here.\n   * Otherwise, it may be a server-side entity that either comes from a local\n   * cache or directly from the server.\n   *\n   * In either case, the renderer should return a presentation that is the most\n   * useful possible for the end user, given the data that is available.\n   */\n  render: (options: {\n    entityRef: string;\n    loading: boolean;\n    entity: Entity | undefined;\n    context: {\n      defaultKind?: string;\n      defaultNamespace?: string;\n    };\n  }) => {\n    snapshot: Omit<EntityRefPresentationSnapshot, 'entityRef'>;\n  };\n}\n\n/**\n * Options for the {@link DefaultEntityPresentationApi}.\n *\n * @public\n */\nexport interface DefaultEntityPresentationApiOptions {\n  /**\n   * The catalog API to use. If you want to use any asynchronous features, you\n   * must supply one.\n   */\n  catalogApi?: CatalogApi;\n\n  /**\n   * When to expire entities that have been loaded from the catalog API and\n   * cached for a while.\n   *\n   * @defaultValue 10 seconds\n   * @remarks\n   *\n   * The higher this value, the lower the load on the catalog API, but also the\n   * higher the risk of users seeing stale data.\n   */\n  cacheTtl?: HumanDuration;\n\n  /**\n   * For how long to wait before sending a batch of entity references to the\n   * catalog API.\n   *\n   * @defaultValue 50 milliseconds\n   * @remarks\n   *\n   * The higher this value, the greater the chance of batching up requests from\n   * across a page, but also the longer the lag time before displaying accurate\n   * information.\n   */\n  batchDelay?: HumanDuration;\n\n  /**\n   * A mapping from kinds to icons.\n   *\n   * @remarks\n   *\n   * The keys are kinds (case insensitive) that map to icon values to represent\n   * kinds by. These are merged with the default set of icons.\n   */\n  kindIcons?: Record<string, IconComponent>;\n\n  /**\n   * A custom renderer, if any.\n   */\n  renderer?: DefaultEntityPresentationApiRenderer;\n}\n\ninterface CacheEntry {\n  updatedAt: number;\n  entity: Entity | undefined;\n}\n\n/**\n * Default implementation of the {@link @backstage/plugin-catalog-react#EntityPresentationApi}.\n *\n * @public\n */\nexport class DefaultEntityPresentationApi implements EntityPresentationApi {\n  /**\n   * Creates a new presentation API that does not reach out to the catalog.\n   */\n  static createLocal(): EntityPresentationApi {\n    return new DefaultEntityPresentationApi({\n      renderer: createDefaultRenderer({ async: false }),\n    });\n  }\n\n  /**\n   * Creates a new presentation API that calls out to the catalog as needed to\n   * get additional information about entities.\n   */\n  static create(\n    options: DefaultEntityPresentationApiOptions,\n  ): EntityPresentationApi {\n    return new DefaultEntityPresentationApi(options);\n  }\n\n  // This cache holds on to all entity data ever loaded, no matter how old. Each\n  // entry is tagged with a timestamp of when it was inserted. We use this map\n  // to be able to always render SOME data even though the information is old.\n  // Entities change very rarely, so it's likely that the rendered information\n  // was perfectly fine in the first place.\n  readonly #cache: Map<string, CacheEntry>;\n  readonly #cacheTtlMs: number;\n  readonly #loader: DataLoader<string, Entity | undefined> | undefined;\n  readonly #kindIcons: Record<string, IconComponent>; // lowercased kinds\n  readonly #renderer: DefaultEntityPresentationApiRenderer;\n\n  private constructor(options: DefaultEntityPresentationApiOptions) {\n    const cacheTtl = options.cacheTtl ?? DEFAULT_CACHE_TTL;\n    const batchDelay = options.batchDelay ?? DEFAULT_BATCH_DELAY;\n    const renderer = options.renderer ?? createDefaultRenderer({ async: true });\n\n    const kindIcons: Record<string, IconComponent> = {};\n    Object.entries(DEFAULT_ICONS).forEach(([kind, icon]) => {\n      kindIcons[kind.toLocaleLowerCase('en-US')] = icon;\n    });\n    Object.entries(options.kindIcons ?? {}).forEach(([kind, icon]) => {\n      kindIcons[kind.toLocaleLowerCase('en-US')] = icon;\n    });\n\n    if (renderer.async) {\n      if (!options.catalogApi) {\n        throw new TypeError(`Asynchronous rendering requires a catalog API`);\n      }\n      this.#loader = this.#createLoader({\n        cacheTtl,\n        batchDelay,\n        renderer,\n        catalogApi: options.catalogApi,\n      });\n    }\n\n    this.#cacheTtlMs = durationToMilliseconds(cacheTtl);\n    this.#cache = new Map();\n    this.#kindIcons = kindIcons;\n    this.#renderer = renderer;\n  }\n\n  /** {@inheritdoc @backstage/plugin-catalog-react#EntityPresentationApi.forEntity} */\n  forEntity(\n    entityOrRef: Entity | string,\n    context?: {\n      defaultKind?: string;\n      defaultNamespace?: string;\n    },\n  ): EntityRefPresentation {\n    const { entityRef, kind, entity, needsLoad } =\n      this.#getEntityForInitialRender(entityOrRef);\n\n    // Make a wrapping helper for rendering\n    const render = (options: {\n      loading: boolean;\n      entity?: Entity;\n    }): EntityRefPresentationSnapshot => {\n      const { snapshot } = this.#renderer.render({\n        entityRef: entityRef,\n        loading: options.loading,\n        entity: options.entity,\n        context: context || {},\n      });\n      return {\n        ...snapshot,\n        entityRef: entityRef,\n        Icon: this.#maybeFallbackIcon(snapshot.Icon, kind),\n      };\n    };\n\n    // First the initial render\n    let initialSnapshot: EntityRefPresentationSnapshot;\n    try {\n      initialSnapshot = render({\n        loading: needsLoad,\n        entity: entity,\n      });\n    } catch {\n      // This is what gets presented if the renderer throws an error\n      initialSnapshot = {\n        primaryTitle: entityRef,\n        entityRef: entityRef,\n      };\n    }\n\n    if (!needsLoad) {\n      return {\n        snapshot: initialSnapshot,\n        promise: Promise.resolve(initialSnapshot),\n      };\n    }\n\n    // Load the entity and render it\n    const maybeUpdatedSnapshot = Promise.resolve()\n      .then(() => {\n        return this.#loader?.load(entityRef);\n      })\n      .then(newEntity => {\n        // We re-render no matter if we get back a new entity or the old\n        // one or nothing, because of the now false loading state - in\n        // case the renderer outputs different data depending on that\n        return render({\n          loading: false,\n          entity: newEntity ?? entity,\n        });\n      })\n      .catch(() => {\n        // Intentionally ignored - we do not propagate errors to the\n        // caller here. The presentation API should be error free and\n        // always return SOMETHING that makes sense to render, and we have\n        // already ensured above that the initial snapshot was that.\n        return undefined;\n      });\n\n    const observable = new ObservableImpl<EntityRefPresentationSnapshot>(\n      subscriber => {\n        let aborted = false;\n\n        maybeUpdatedSnapshot\n          .then(updatedSnapshot => {\n            if (updatedSnapshot) {\n              subscriber.next(updatedSnapshot);\n            }\n          })\n          .finally(() => {\n            if (!aborted) {\n              subscriber.complete();\n            }\n          });\n\n        return () => {\n          aborted = true;\n        };\n      },\n    );\n\n    const promise = maybeUpdatedSnapshot.then(updatedSnapshot => {\n      return updatedSnapshot ?? initialSnapshot;\n    });\n\n    return {\n      snapshot: initialSnapshot,\n      update$: observable,\n      promise: promise,\n    };\n  }\n\n  #getEntityForInitialRender(entityOrRef: Entity | string): {\n    entity: Entity | undefined;\n    kind: string;\n    entityRef: string;\n    needsLoad: boolean;\n  } {\n    // If we were given an entity in the first place, we use it for a single\n    // pass of rendering and assume that it's up to date and not partial (i.e.\n    // we expect that it wasn't fetched in such a way that the required fields\n    // of the renderer were excluded)\n    if (typeof entityOrRef !== 'string') {\n      return {\n        entity: entityOrRef,\n        kind: entityOrRef.kind,\n        entityRef: stringifyEntityRef(entityOrRef),\n        needsLoad: false,\n      };\n    }\n\n    const cached = this.#cache.get(entityOrRef);\n    const cachedEntity: Entity | undefined = cached?.entity;\n    const cacheNeedsUpdate =\n      !cached || Date.now() - cached.updatedAt > this.#cacheTtlMs;\n    const needsLoad =\n      cacheNeedsUpdate &&\n      this.#renderer.async !== false &&\n      this.#loader !== undefined;\n\n    return {\n      entity: cachedEntity,\n      kind: parseEntityRef(entityOrRef).kind,\n      entityRef: entityOrRef,\n      needsLoad,\n    };\n  }\n\n  #createLoader(options: {\n    catalogApi: CatalogApi;\n    cacheTtl: HumanDuration;\n    batchDelay: HumanDuration;\n    renderer: DefaultEntityPresentationApiRenderer;\n  }): DataLoader<string, Entity | undefined> {\n    const cacheTtlMs = durationToMilliseconds(options.cacheTtl);\n    const batchDelayMs = durationToMilliseconds(options.batchDelay);\n\n    return new DataLoader(\n      async (entityRefs: readonly string[]) => {\n        const { items } = await options.catalogApi!.getEntitiesByRefs({\n          entityRefs: entityRefs as string[],\n          fields: [\n            'kind',\n            'metadata.name',\n            'metadata.namespace',\n            'metadata.title',\n            'metadata.description',\n            'spec.profile.displayName',\n            'spec.type',\n          ],\n        });\n\n        const now = Date.now();\n        entityRefs.forEach((entityRef, index) => {\n          this.#cache.set(entityRef, {\n            updatedAt: now,\n            entity: items[index],\n          });\n        });\n\n        return items;\n      },\n      {\n        name: 'DefaultEntityPresentationApi',\n        // This cache is the one that the data loader uses internally for\n        // memoizing requests; essentially what it achieves is that multiple\n        // requests for the same entity ref will be batched up into a single\n        // request and then the resulting promises are held on to. We put an\n        // expiring map here, which makes it so that it re-fetches data with the\n        // expiry cadence of that map. Otherwise it would only fetch a given ref\n        // once and then never try again. This cache does therefore not fulfill\n        // the same purpose as the one that is in the root of the class.\n        cacheMap: new ExpiryMap(cacheTtlMs),\n        maxBatchSize: 100,\n        batchScheduleFn: batchDelayMs\n          ? cb => setTimeout(cb, batchDelayMs)\n          : undefined,\n      },\n    );\n  }\n\n  #maybeFallbackIcon(\n    renderedIcon: IconComponent | false | undefined,\n    kind: string,\n  ): IconComponent | false | undefined {\n    if (renderedIcon) {\n      return renderedIcon;\n    } else if (renderedIcon === false) {\n      return false;\n    }\n\n    return this.#kindIcons[kind.toLocaleLowerCase('en-US')];\n  }\n}\n"],"names":[],"mappings":"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"}