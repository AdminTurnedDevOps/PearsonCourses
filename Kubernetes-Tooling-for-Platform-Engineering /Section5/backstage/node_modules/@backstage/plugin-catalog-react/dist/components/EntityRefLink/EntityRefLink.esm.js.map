{"version":3,"file":"EntityRefLink.esm.js","sources":["../../../src/components/EntityRefLink/EntityRefLink.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  CompoundEntityRef,\n  DEFAULT_NAMESPACE,\n  Entity,\n  parseEntityRef,\n} from '@backstage/catalog-model';\nimport { Link, LinkProps } from '@backstage/core-components';\nimport { useRouteRef } from '@backstage/core-plugin-api';\nimport React, { forwardRef } from 'react';\nimport { entityRouteRef } from '../../routes';\nimport { EntityDisplayName } from '../EntityDisplayName';\n\n/**\n * Props for {@link EntityRefLink}.\n *\n * @public\n */\nexport type EntityRefLinkProps = {\n  entityRef: Entity | CompoundEntityRef | string;\n  defaultKind?: string;\n  defaultNamespace?: string;\n  /** @deprecated This option should no longer be used; presentation is requested through the {@link entityPresentationApiRef} instead */\n  title?: string;\n  children?: React.ReactNode;\n  hideIcon?: boolean;\n  disableTooltip?: boolean;\n} & Omit<LinkProps, 'to'>;\n\n/**\n * Shows a clickable link to an entity.\n *\n * @public\n */\nexport const EntityRefLink = forwardRef<any, EntityRefLinkProps>(\n  (props, ref) => {\n    const {\n      entityRef,\n      defaultKind,\n      defaultNamespace,\n      title,\n      children,\n      hideIcon,\n      disableTooltip,\n      ...linkProps\n    } = props;\n    const entityRoute = useEntityRoute(props.entityRef);\n\n    const content = children ?? title ?? (\n      <EntityDisplayName\n        entityRef={entityRef}\n        defaultKind={defaultKind}\n        defaultNamespace={defaultNamespace}\n        hideIcon={hideIcon}\n        disableTooltip={disableTooltip}\n      />\n    );\n\n    return (\n      <Link {...linkProps} ref={ref} to={entityRoute}>\n        {content}\n      </Link>\n    );\n  },\n) as (props: EntityRefLinkProps) => JSX.Element;\n\n// Hook that computes the route to a given entity / ref. This is a bit\n// contrived, because it tries to retain the casing of the entity name if\n// present, but not of other parts. This is in an attempt to make slightly more\n// nice-looking URLs.\nfunction useEntityRoute(\n  entityRef: Entity | CompoundEntityRef | string,\n): string {\n  const entityRoute = useRouteRef(entityRouteRef);\n\n  let kind;\n  let namespace;\n  let name;\n\n  if (typeof entityRef === 'string') {\n    const parsed = parseEntityRef(entityRef);\n    kind = parsed.kind;\n    namespace = parsed.namespace;\n    name = parsed.name;\n  } else if ('metadata' in entityRef) {\n    kind = entityRef.kind;\n    namespace = entityRef.metadata.namespace;\n    name = entityRef.metadata.name;\n  } else {\n    kind = entityRef.kind;\n    namespace = entityRef.namespace;\n    name = entityRef.name;\n  }\n\n  kind = kind.toLocaleLowerCase('en-US');\n  namespace = namespace?.toLocaleLowerCase('en-US') ?? DEFAULT_NAMESPACE;\n\n  const routeParams = {\n    kind: encodeURIComponent(kind),\n    namespace: encodeURIComponent(namespace),\n    name: encodeURIComponent(name),\n  };\n\n  return entityRoute(routeParams);\n}\n"],"names":[],"mappings":";;;;;;;AAiDO,MAAM,aAAgB,GAAA,UAAA;AAAA,EAC3B,CAAC,OAAO,GAAQ,KAAA;AACd,IAAM,MAAA;AAAA,MACJ,SAAA;AAAA,MACA,WAAA;AAAA,MACA,gBAAA;AAAA,MACA,KAAA;AAAA,MACA,QAAA;AAAA,MACA,QAAA;AAAA,MACA,cAAA;AAAA,MACA,GAAG;AAAA,KACD,GAAA,KAAA;AACJ,IAAM,MAAA,WAAA,GAAc,cAAe,CAAA,KAAA,CAAM,SAAS,CAAA;AAElD,IAAM,MAAA,OAAA,GAAU,YAAY,KAC1B,oBAAA,KAAA,CAAA,aAAA;AAAA,MAAC,iBAAA;AAAA,MAAA;AAAA,QACC,SAAA;AAAA,QACA,WAAA;AAAA,QACA,gBAAA;AAAA,QACA,QAAA;AAAA,QACA;AAAA;AAAA,KACF;AAGF,IAAA,2CACG,IAAM,EAAA,EAAA,GAAG,WAAW,GAAU,EAAA,EAAA,EAAI,eAChC,OACH,CAAA;AAAA;AAGN;AAMA,SAAS,eACP,SACQ,EAAA;AACR,EAAM,MAAA,WAAA,GAAc,YAAY,cAAc,CAAA;AAE9C,EAAI,IAAA,IAAA;AACJ,EAAI,IAAA,SAAA;AACJ,EAAI,IAAA,IAAA;AAEJ,EAAI,IAAA,OAAO,cAAc,QAAU,EAAA;AACjC,IAAM,MAAA,MAAA,GAAS,eAAe,SAAS,CAAA;AACvC,IAAA,IAAA,GAAO,MAAO,CAAA,IAAA;AACd,IAAA,SAAA,GAAY,MAAO,CAAA,SAAA;AACnB,IAAA,IAAA,GAAO,MAAO,CAAA,IAAA;AAAA,GAChB,MAAA,IAAW,cAAc,SAAW,EAAA;AAClC,IAAA,IAAA,GAAO,SAAU,CAAA,IAAA;AACjB,IAAA,SAAA,GAAY,UAAU,QAAS,CAAA,SAAA;AAC/B,IAAA,IAAA,GAAO,UAAU,QAAS,CAAA,IAAA;AAAA,GACrB,MAAA;AACL,IAAA,IAAA,GAAO,SAAU,CAAA,IAAA;AACjB,IAAA,SAAA,GAAY,SAAU,CAAA,SAAA;AACtB,IAAA,IAAA,GAAO,SAAU,CAAA,IAAA;AAAA;AAGnB,EAAO,IAAA,GAAA,IAAA,CAAK,kBAAkB,OAAO,CAAA;AACrC,EAAY,SAAA,GAAA,SAAA,EAAW,iBAAkB,CAAA,OAAO,CAAK,IAAA,iBAAA;AAErD,EAAA,MAAM,WAAc,GAAA;AAAA,IAClB,IAAA,EAAM,mBAAmB,IAAI,CAAA;AAAA,IAC7B,SAAA,EAAW,mBAAmB,SAAS,CAAA;AAAA,IACvC,IAAA,EAAM,mBAAmB,IAAI;AAAA,GAC/B;AAEA,EAAA,OAAO,YAAY,WAAW,CAAA;AAChC;;;;"}