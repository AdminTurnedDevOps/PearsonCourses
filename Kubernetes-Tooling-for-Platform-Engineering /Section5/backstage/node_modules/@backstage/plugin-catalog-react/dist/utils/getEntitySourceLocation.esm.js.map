{"version":3,"file":"getEntitySourceLocation.esm.js","sources":["../../src/utils/getEntitySourceLocation.ts"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ANNOTATION_SOURCE_LOCATION,\n  Entity,\n  parseLocationRef,\n} from '@backstage/catalog-model';\nimport { scmIntegrationsApiRef } from '@backstage/integration-react';\n\n/** @public */\nexport type EntitySourceLocation = {\n  locationTargetUrl: string;\n  integrationType?: string;\n};\n\n/** @public */\nexport function getEntitySourceLocation(\n  entity: Entity,\n  scmIntegrationsApi: typeof scmIntegrationsApiRef.T,\n): EntitySourceLocation | undefined {\n  const sourceLocation =\n    entity.metadata.annotations?.[ANNOTATION_SOURCE_LOCATION];\n\n  if (!sourceLocation) {\n    return undefined;\n  }\n\n  try {\n    const sourceLocationRef = parseLocationRef(sourceLocation);\n    const integration = scmIntegrationsApi.byUrl(sourceLocationRef.target);\n    return {\n      locationTargetUrl: sourceLocationRef.target,\n      integrationType: integration?.type,\n    };\n  } catch {\n    return undefined;\n  }\n}\n"],"names":[],"mappings":";;AA8BgB,SAAA,uBAAA,CACd,QACA,kBACkC,EAAA;AAClC,EAAA,MAAM,cACJ,GAAA,MAAA,CAAO,QAAS,CAAA,WAAA,GAAc,0BAA0B,CAAA;AAE1D,EAAA,IAAI,CAAC,cAAgB,EAAA;AACnB,IAAO,OAAA,KAAA,CAAA;AAAA;AAGT,EAAI,IAAA;AACF,IAAM,MAAA,iBAAA,GAAoB,iBAAiB,cAAc,CAAA;AACzD,IAAA,MAAM,WAAc,GAAA,kBAAA,CAAmB,KAAM,CAAA,iBAAA,CAAkB,MAAM,CAAA;AACrE,IAAO,OAAA;AAAA,MACL,mBAAmB,iBAAkB,CAAA,MAAA;AAAA,MACrC,iBAAiB,WAAa,EAAA;AAAA,KAChC;AAAA,GACM,CAAA,MAAA;AACN,IAAO,OAAA,KAAA,CAAA;AAAA;AAEX;;;;"}