!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e=e||self).Rifm={},e.React)}(this,function(e,t){"use strict";var o=function(e){var t,o;function n(t){var o;return(o=e.call(this,t)||this)._state=null,o._del=!1,o._handleChange=function(e){var t=o.state.value,n=e.target.value,r=e.target,a=n.length>t.length,s=o._del,i=t===o.props.format(n);o.setState({value:n,local:!0},function(){var e=r.selectionStart,u=o.props.refuse||/[^\d]+/g,l=n.substr(0,e).replace(u,"");if(o._state={input:r,before:l,op:a,di:s&&i,del:s},o.props.replace&&o.props.replace(t)&&a&&!i){for(var p=-1,c=0;c!==l.length;++c)p=Math.max(p,n.toLowerCase().indexOf(l[c].toLowerCase(),p+1));var d=n.substr(p+1).replace(u,"")[0];p=n.indexOf(d,p+1),n=""+n.substr(0,p)+n.substr(p+1)}var f=o.props.format(n);t===f?o.setState({value:n}):o.props.onChange(f)})},o._hKD=function(e){"Delete"===e.code&&(o._del=!0)},o._hKU=function(e){"Delete"===e.code&&(o._del=!1)},o.state={value:t.value,local:!0},o}o=e,(t=n).prototype=Object.create(o.prototype),t.prototype.constructor=t,t.__proto__=o,n.getDerivedStateFromProps=function(e,t){return{value:t.local?t.value:e.value,local:!1}};var r=n.prototype;return r.render=function(){var e=this._handleChange,t=this.state.value;return(0,this.props.children)({value:t,onChange:e})},r.componentWillUnmount=function(){document.removeEventListener("keydown",this._hKD),document.removeEventListener("keyup",this._hKU)},r.componentDidMount=function(){document.addEventListener("keydown",this._hKD),document.addEventListener("keyup",this._hKU)},r.componentDidUpdate=function(){var e=this._state;if(e){for(var t=this.state.value,o=-1,n=0;n!==e.before.length;++n)o=Math.max(o,t.toLowerCase().indexOf(e.before[n].toLowerCase(),o+1));if(this.props.replace&&(e.op||e.del&&!e.di))for(;t[o+1]&&(this.props.refuse||/[^\d]+/).test(t[o+1]);)o+=1;e.input.selectionStart=e.input.selectionEnd=o+1+(e.di?1:0)}this._state=null},n}(t.Component);e.Rifm=o,Object.defineProperty(e,"__esModule",{value:!0})});
